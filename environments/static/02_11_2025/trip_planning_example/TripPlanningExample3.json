{
    "name": "TripPlanningExample3",
    "author": "Human",
    "agents": {
        "number": 3,
        "names": [
            "flight_planner",
            "scheduler",
            "orchestrator"
        ],
        "flight_planner": {
            "private_information": [
                "I only consider direct flights when suggesting city transitions.",
                "Staying in the same city for consecutive days is always allowed."
            ],
            "goal": "Analyze the direct flight graph and produce feasible city-to-city transitions and sample 6-day routes consistent with the public constraints."
        },
        "scheduler": {
            "private_information": [
                "I prioritize hard constraints first (6 total days, 2 days in Bucharest, meeting friend in Bucharest on day 5 or 6, only direct flights for city changes).",
                "I treat 3-day stays in Berlin and Warsaw as soft preferences and may balance them to fit the 6-day horizon."
            ],
            "goal": "Allocate each of the 6 days to a city, meeting the direct-flight constraints, ensuring exactly 2 days in Bucharest and scheduling the friend meeting on day 5 or day 6."
        },
        "orchestrator": {
            "private_information": [],
            "goal": "Integrate the flight feasibility and the day allocation into a final PDDL domain and problem compatible with the Fast Downward solver that yields a valid 6-day plan."
        }
    },
    "environment": {
        "init": {
            "days_total": 6,
            "days_labels": [
                "d1",
                "d2",
                "d3",
                "d4",
                "d5",
                "d6"
            ],
            "cities": [
                "berlin",
                "warsaw",
                "bucharest"
            ],
            "direct_flights": [
                [
                    "berlin",
                    "warsaw"
                ],
                [
                    "warsaw",
                    "berlin"
                ],
                [
                    "warsaw",
                    "bucharest"
                ],
                [
                    "bucharest",
                    "warsaw"
                ]
            ]
        },
        "public_information": [
            "Total trip length is 6 days (d1 through d6).",
            "Cities under consideration: Berlin, Warsaw, Bucharest.",
            "Only direct flights are allowed between cities; you may also remain in the same city on consecutive days.",
            "Direct flights exist between Berlin and Warsaw, and between Warsaw and Bucharest; there is no direct flight between Berlin and Bucharest.",
            "You plan to stay in Bucharest for 2 days.",
            "You want to meet a friend in Bucharest on day 5 or day 6.",
            "You would like to visit Berlin for 3 days (preference).",
            "You would like to visit Warsaw for 3 days (preference)."
        ]
    },
    "workflow": {
        "flight_planner": {
            "analyze_flights": {
                "input": [],
                "output": "flight_options",
                "system_prompt": "You are an expert in flight-graph reasoning for simple multi-day trip planning. You produce concise, structured outputs capturing direct-flight feasibility over a small time horizon.",
                "prompt": "Your name is flight_planner. You are in an environment with the following public information: {environment->public_information} Using only the direct flights provided and allowing stays in place, analyze feasible transitions and propose at least one 6-day city sequence that enables spending 2 total days in Bucharest and being in Bucharest on day 5 or day 6. Treat 3-day stays in Berlin and Warsaw as soft preferences that may be relaxed to fit the 6-day constraint. Return a compact JSON object with keys: adjacency (map of city to directly reachable cities), sample_route (array of 6 city names in day order), and notes (short justification)."
            }
        },
        "scheduler": {
            "allocate_days": {
                "input": [
                    "flight_options"
                ],
                "output": "day_allocation",
                "system_prompt": "You are a trip scheduler who assigns each day to a city while respecting hard constraints and acknowledging soft preferences.",
                "prompt": "Your name is scheduler. You are in an environment with the following public information: {environment->public_information} You also have flight feasibility and a sample route: {flight_options} Produce a definitive 6-day allocation mapping each day d1..d6 to a city that satisfies: exactly 2 days in Bucharest, meeting a friend in Bucharest on day 5 or day 6, and only direct flights when changing cities between consecutive days. If preferences for 3 days in Berlin and 3 days in Warsaw cannot both be satisfied within 6 days, balance them and explain briefly. Return a compact JSON object with keys: plan (object mapping d1..d6 to a city), meeting_day (either d5 or d6), city_day_counts (counts per city), and rationale (one or two sentences)."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "flight_options",
                    "day_allocation"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert with multi-agent PDDL problems for classical planning. You must produce a valid PDDL domain and problem that can be solved by the Fast Downward solver. Always enclose the PDDL domain between <domain></domain> tags and the PDDL problem between <problem></problem> tags. Use only STRIPS/ADL features supported by Fast Downward (e.g., :typing, :negative-preconditions).",
                "prompt": "Integrate the context and finalize a solvable PDDL encoding for the 6-day trip: Public information: {environment->public_information} Flight feasibility: {flight_options} Proposed day allocation: {day_allocation} Build a domain for scheduling one day at a time with actions to either stay or fly to a directly connected city, using a day cursor and a current-city marker. Include types city and day, predicates connected, next, cursor, pos, assigned, in, and start. Provide three actions: start-in (choose the first day and establish initial city), assign-stay (stay in the same city), and assign-fly (move via a direct flight). To avoid end-of-horizon issues, model a terminal day d7 as a cursor sink (do not require it to be assigned). In the problem file, declare objects berlin, warsaw, bucharest as cities and d1..d7 as days; initialize the connected facts per the direct flights and next links d1->d2, d2->d3, d3->d4, d4->d5, d5->d6, d6->d7; set start and cursor d1. Set the goal to have all of d1..d6 assigned and to realize a concrete allocation consistent with the provided plan and meeting in Bucharest on day 5 or day 6; if the provided plan specifies exact cities per day, encode those as goal literals in(city,day). Ensure the final output contains only the PDDL domain and problem wrapped in the required tags and is ready for Fast Downward.",
                "template": {
                    "domain": "<domain>\n(define (domain trip-scheduling)\n (:requirements :strips :typing :negative-preconditions)\n (:types city day)\n (:predicates\n  (connected ?c1 - city ?c2 - city)\n  (next ?d - day ?d2 - day)\n  (cursor ?d - day)\n  (pos ?c - city)\n  (assigned ?d - day)\n  (in ?c - city ?d - day)\n  (start)\n )\n (:action start-in\n  :parameters (?c - city ?d - day ?d2 - day)\n  :precondition (and (start) (cursor ?d) (next ?d ?d2) (not (assigned ?d)))\n  :effect (and (in ?c ?d) (assigned ?d) (pos ?c) (not (start)) (not (cursor ?d)) (cursor ?d2))\n )\n (:action assign-stay\n  :parameters (?c - city ?d - day ?d2 - day)\n  :precondition (and (pos ?c) (cursor ?d) (next ?d ?d2) (not (assigned ?d)))\n  :effect (and (in ?c ?d) (assigned ?d) (not (cursor ?d)) (cursor ?d2))\n )\n (:action assign-fly\n  :parameters (?from - city ?to - city ?d - day ?d2 - day)\n  :precondition (and (pos ?from) (connected ?from ?to) (cursor ?d) (next ?d ?d2) (not (assigned ?d)))\n  :effect (and (in ?to ?d) (assigned ?d) (pos ?to) (not (cursor ?d)) (cursor ?d2))\n )\n)\n</domain>",
                    "problem_example": "<problem>\n(define (problem trip-6days)\n (:domain trip-scheduling)\n (:objects berlin warsaw bucharest - city d1 d2 d3 d4 d5 d6 d7 - day)\n (:init\n  (connected berlin warsaw)\n  (connected warsaw berlin)\n  (connected warsaw bucharest)\n  (connected bucharest warsaw)\n  (next d1 d2)\n  (next d2 d3)\n  (next d3 d4)\n  (next d4 d5)\n  (next d5 d6)\n  (next d6 d7)\n  (start)\n  (cursor d1)\n )\n (:goal (and\n  (assigned d1) (assigned d2) (assigned d3) (assigned d4) (assigned d5) (assigned d6)\n  (in berlin d1) (in berlin d2)\n  (in warsaw d3) (in warsaw d4)\n  (in bucharest d5) (in bucharest d6)\n ))\n)\n</problem>"
                }
            }
        },
        "constraints": [
            "flight_planner.analyze_flights->orchestrator.pddl",
            "scheduler.allocate_days->orchestrator.pddl"
        ]
    }
}