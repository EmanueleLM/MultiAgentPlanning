{
    "name": "TripPlanningExample5",
    "author": "Human",
    "agents": {
        "number": 3,
        "names": [
            "stay_planner",
            "flight_mapper",
            "orchestrator"
        ],
        "stay_planner": {
            "private_information": [
                "Target daily allocation across 16 total days",
                "Hard targets: Oslo 6 days, Porto 7 days",
                "Soft target: Dubrovnik 5 days if possible, but total must remain 16 days",
                "Must be in Dubrovnik on day 12 and day 16 for a conference",
                "Only direct flights allowed between city pairs"
            ],
            "goal": "Propose a feasible 16-day day-by-day city stay plan that satisfies hard constraints (Oslo = 6, Porto = 7, Dubrovnik includes day 12 and day 16) and stays within direct-flight connectivity. If the soft target for Dubrovnik (5 days) cannot be met due to the 16-day limit, minimize deviation while keeping the plan feasible."
        },
        "flight_mapper": {
            "private_information": [
                "You are responsible for validating and, if necessary, minimally adjusting the candidate itinerary to comply with direct-flight constraints",
                "Direct flights exist between Oslo and Dubrovnik, and between Porto and Oslo; there are no direct flights between Porto and Dubrovnik"
            ],
            "goal": "Validate the proposed day-by-day itinerary against direct-flight constraints. If a transition violates connectivity, adjust by reassigning days or regrouping stays with minimal changes while preserving hard constraints and the conference days in Dubrovnik on days 12 and 16."
        },
        "orchestrator": {
            "private_information": [
                "Integrate the validated itinerary into a final PDDL planning instance",
                "Encode constraints for 16 days, direct-flight connectivity, and specific day-city assignments (including Dubrovnik on day 12 and day 16)",
                "Produce PDDL domain and problem that the FastDownward solver can handle"
            ],
            "goal": "Generate a final PDDL domain and problem that captures the validated 16-day plan with direct-flight constraints and mandatory conference days in Dubrovnik (days 12 and 16). The problem should be solvable by FastDownward."
        }
    },
    "environment": {
        "init": {
            "days": 16,
            "cities": [
                "Oslo",
                "Porto",
                "Dubrovnik"
            ],
            "direct_flights": [
                [
                    "Oslo",
                    "Dubrovnik"
                ],
                [
                    "Dubrovnik",
                    "Oslo"
                ],
                [
                    "Porto",
                    "Oslo"
                ],
                [
                    "Oslo",
                    "Porto"
                ]
            ],
            "visibility": "public"
        },
        "public_information": [
            "Trip length is 16 days total.",
            "You plan to stay in Oslo for 6 days.",
            "You plan to stay in Porto for 7 days.",
            "You would like to visit Dubrovnik for 5 days, but the total must remain 16 days.",
            "You must be in Dubrovnik on day 12 and on day 16 to attend a conference.",
            "Only direct flights are allowed for city changes.",
            "Known direct flights: Oslo <-> Dubrovnik, Porto <-> Oslo.",
            "There is no direct flight between Porto and Dubrovnik."
        ]
    },
    "workflow": {
        "stay_planner": {
            "plan": {
                "input": [],
                "output": "candidate_itinerary",
                "system_prompt": "You are a travel itinerary designer who creates day-by-day plans over a fixed horizon. Produce a compact JSON-only output with an array of 16 entries, one per day, each entry containing the day number (1-based) and the assigned city. Ensure hard constraints are satisfied and the plan uses only cities Oslo, Porto, and Dubrovnik.",
                "prompt": "Context: {environment->public_information}. Private knowledge: {agents->stay_planner->private_information}. Objective: {agents->stay_planner->goal}. Deliverable: Output strictly in JSON with keys itinerary (list of {day, city}), summary (counts per city), and notes (brief rationale). A feasible high-quality example is: days 1-7 in Porto, days 8-10 in Oslo, day 11 in Dubrovnik, day 12 in Dubrovnik (conference), days 13-15 in Oslo, day 16 in Dubrovnik (conference). If you propose a different plan, it must also satisfy the constraints."
            }
        },
        "flight_mapper": {
            "validate": {
                "input": [
                    "candidate_itinerary"
                ],
                "output": "validated_itinerary",
                "system_prompt": "You validate and minimally adjust itineraries to enforce direct-flight connectivity. Output a JSON-only object including the final itinerary, the list of flight transitions with their days (from_city, to_city, day_from_to), and a validation report.",
                "prompt": "Public information: {environment->public_information}. Input candidate itinerary: {candidate_itinerary}. Task: Verify that every day-to-day city change follows a direct flight. Allowed direct flights are only between the pairs indicated in the public information. If a transition is invalid, adjust by reassigning days or regrouping stays with minimal changes and without violating: total = 16 days, Oslo = 6 days, Porto = 7 days, Dubrovnik contains day 12 and day 16. Output strictly as JSON with keys itinerary (list of {day, city}), flights (list of {from, to, day_from, day_to}), and report (string)."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "validated_itinerary"
                ],
                "output": "pddl_trip",
                "system_prompt": "You are an expert in PDDL for classical planning and FastDownward. Produce a PDDL domain and problem that encode a 16-day city assignment with direct-flight constraints. The domain should allow assigning each day sequentially, either staying in the same city or flying along declared direct-flight edges. The problem must include objects for cities and days (including a start day d00), next-day relations, start and progress predicates, and flight relations. The goal must make the validated itinerary true (including Dubrovnik on days 12 and 16).",
                "prompt": "You will generate the final PDDL domain and problem for FastDownward. Use types day and city. Predicates should include at(?d - day ?c - city), assigned(?d - day), progress(?d - day), next(?d1 - day ?d2 - day), start(?d - day), and flight(?c1 - city ?c2 - city). Provide three actions: assign_next_start (from start day to day 1), assign_next_stay (copy previous day's city), and assign_next_fly (move along a flight edge). The initial state must declare start(d00), progress(d00), the next-chain from d00 to d01, d01 to d02, ..., d15 to d16, and the flight relations from the environment public information. For the goal, require assigned(d01..d16) and at(dk, city_k) for each day k according to the validated itinerary. Use lowercase object names for cities (porto, oslo, dubrovnik) and days (d00..d16). Input validated itinerary: {validated_itinerary}. Enclose the domain between <domain></domain> and the problem between <problem></problem> tags, and keep each as a single line suitable for FastDownward."
            }
        },
        "constraints": [
            "stay_planner.plan->flight_mapper.validate",
            "flight_mapper.validate->orchestrator.pddl"
        ]
    }
}