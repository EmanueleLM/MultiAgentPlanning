{
    "name": "Blocksworld29",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "domain_modeler",
            "problem_builder",
            "consistency_auditor",
            "orchestrator"
        ],
        "domain_modeler": {
            "private_information": [
                "You are responsible for formalizing the Blocks World as a clean, minimal, STRIPS-style domain with standard predicates and action schemas.",
                "Capture the action semantics for pickup, putdown, unstack, and stack; include all necessary preconditions and effects, including hand state updates and clear/ontable/on relations."
            ],
            "goal": "Deliver a normalized, solver-agnostic domain schema (not PDDL) that precisely matches the stated action restrictions."
        },
        "problem_builder": {
            "private_information": [
                "You will parse the human statements into structured initial states, goals, and any provided plans.",
                "Use consistent symbol names across both scenarios: blocks are red, blue, yellow, orange; hand is hand; predicates are on(x,y), ontable(x), clear(x), holding(x), handempty."
            ],
            "goal": "Produce structured problem instances for both statements, aligned with the domain_modeler symbols; include a normalized version of the first plan and leave the second for planning."
        },
        "consistency_auditor": {
            "private_information": [
                "You audit temporal and causal consistency of the provided plan and remove any bookkeeping shortcuts or post-hoc penalties.",
                "You verify that each step\u2019s preconditions are satisfied by the current state and that effects are properly applied, including frame axioms and clear/hand updates.",
                "You propose corrections if the given plan violates constraints, and you produce a sound plan for the second scenario."
            ],
            "goal": "Validate and, if needed, repair the plan for the first scenario; synthesize a consistent plan for the second scenario; ensure both plans respect the modeled domain and restrictions."
        },
        "orchestrator": {
            "private_information": [
                "You coordinate all outputs and compile the final PDDL artifacts for the FastDownward solver.",
                "You must produce a single Blocks World PDDL domain and two PDDL problem files (one per statement)."
            ],
            "goal": "Integrate the domain specification, structured problems, and audit results into final PDDL domain and two problems suitable for FastDownward."
        }
    },
    "environment": {
        "init": {
            "domain_name": "blocksworld",
            "objects": {
                "blocks": [
                    "red",
                    "blue",
                    "yellow",
                    "orange"
                ],
                "hand": "hand"
            },
            "requirements": [
                ":strips"
            ]
        },
        "public_information": [
            "Actions available: Pick up a block; Unstack a block from on top of another block; Put down a block; Stack a block on top of another block.",
            "Restrictions: Only one block can be picked up or unstacked at a time; You can only pick up or unstack if the hand is empty; You can only pick up a block if it is on the table and clear; You can only unstack a block from on top of another block if it was indeed on top of that block; You can only unstack a block if it is clear; After pick up or unstack, you are holding the block; You can only put down a block you are holding; You can only stack a block you are holding; You can only stack onto a block that is clear; After put down or stack, the hand becomes empty; When you stack a block onto another, the lower block is no longer clear.",
            "[STATEMENT 1] Initial conditions: orange is clear; yellow is clear; hand is empty; blue is on red; yellow is on blue; red is on the table; orange is on the table.",
            "[STATEMENT 1] Goal: blue is on yellow; yellow is on orange.",
            "[STATEMENT 1] Plan (natural language): unstack yellow from blue; stack yellow on orange; unstack blue from red; stack blue on yellow.",
            "[STATEMENT 2] Initial conditions: red is clear; blue is clear; hand is empty; red is on orange; blue is on yellow; orange is on the table; yellow is on the table.",
            "[STATEMENT 2] Goal: red is on orange; blue is on red.",
            "[STATEMENT 2] Plan: not provided; must be synthesized."
        ]
    },
    "workflow": {
        "domain_modeler": {
            "build_domain_spec": {
                "input": [],
                "output": "domain_spec",
                "system_prompt": "You are a domain modeling expert. Produce a normalized, solver-agnostic, STRIPS-like specification for Blocks World that exactly enforces the public restrictions. Define: predicates = {on(x,y), ontable(x), clear(x), holding(x), handempty}; actions = {pickup(x), putdown(x), unstack(x,y), stack(x,y)} with explicit preconditions and effects, including clear/hand updates and exclusivity (only one block held at a time). Return a compact JSON object with keys: name, predicates, actions (each with parameters, preconditions, add_effects, del_effects). Do not output PDDL.",
                "prompt": "Your name is domain_modeler. Consider the environment public information {environment->public_information}. Your task is to capture the Blocks World rules into a minimal STRIPS-style domain schema using the standard predicates. Ensure all restrictions are represented exactly, no shortcuts or implicit assumptions. Output a JSON object describing the domain; do not emit PDDL."
            }
        },
        "problem_builder": {
            "extract_problems": {
                "input": [],
                "output": "problem_specs",
                "system_prompt": "You are a problem instance builder. Parse the two statements into structured instances that align with the domain_modeler symbols. For each problem i in {1,2}, produce: objects (list of blocks plus hand), init (facts), goal (facts), and if available plan_natural and plan_symbolic (map steps to action schema with parameters). Use symbols: red, blue, yellow, orange, hand; predicates: on, ontable, clear, holding, handempty. Do not output PDDL.",
                "prompt": "Your name is problem_builder. Using the environment public information {environment->public_information}, extract two problem instances. Normalize all facts and plans using the exact predicate names and object symbols. Provide a JSON object with keys problems: [{id: 1, objects, init, goal, plan_natural, plan_symbolic}, {id: 2, objects, init, goal}]. Do not emit PDDL."
            }
        },
        "consistency_auditor": {
            "audit": {
                "input": [
                    "domain_spec",
                    "problem_specs"
                ],
                "output": "audit_report",
                "system_prompt": "You are a temporal/causal consistency auditor. Verify that the provided (symbolic) plan for problem 1 is valid under the domain_spec by simulating step-by-step with frame axioms and ensuring all preconditions hold; check that no bookkeeping shortcuts are used (e.g., assuming hand becomes empty without an action). If invalid, produce a minimally repaired plan. For problem 2, synthesize a valid plan that satisfies the goal. Return a JSON report containing: validity_problem1 (boolean), issues_problem1 (list), repaired_plan1 (if needed), synthesized_plan2 (list), and any invariants or notes. Do not output PDDL.",
                "prompt": "Your name is consistency_auditor. Audit the problem instances in {problem_specs} against the domain model {domain_spec}. Ensure each action\u2019s preconditions/effects match, hand exclusivity is respected, and clear/on/ontable bookkeeping is correct. Repair plan 1 if necessary; create a sound plan for problem 2. Return a concise JSON report focusing on causality and temporal correctness, with no solver tokens or penalties."
            }
        },
        "orchestrator": {
            "pddl_fd": {
                "input": [
                    "domain_spec",
                    "problem_specs",
                    "audit_report"
                ],
                "output": "pddl_fd",
                "system_prompt": "You are an expert in compiling structured domain/problem specifications into PDDL for the FastDownward solver. Produce one PDDL domain and two PDDL problem files (problem1 and problem2). Use the domain name blocksworld, predicates {on ?x ?y, ontable ?x, clear ?x, holding ?x, handempty}, and actions {pickup, putdown, unstack, stack} with correct STRIPS preconditions/effects. For problem 1, use the audited (repaired if necessary) plan only as a reference but output only the domain and problem definitions; for problem 2, output only its problem definition. Enclose the PDDL domain between <domain></domain> tags and each PDDL problem between <problem id=\"1\"></problem> and <problem id=\"2\"></problem> tags, respectively. Ensure the output is fully compatible with FastDownward.",
                "prompt": "Integrate the modeled domain {domain_spec}, the parsed problems {problem_specs}, and the audit outcomes {audit_report}. Generate a single Blocks World PDDL domain and two problems. Ensure initial states and goals exactly reflect each statement; preserve consistent object naming (red, blue, yellow, orange). Do not include plans in the PDDL. Return the PDDL domain and both problem files enclosed in the specified tags."
            }
        },
        "constraints": [
            "domain_modeler.build_domain_spec->consistency_auditor.audit",
            "problem_builder.extract_problems->consistency_auditor.audit",
            "domain_modeler.build_domain_spec->orchestrator.pddl_fd",
            "problem_builder.extract_problems->orchestrator.pddl_fd",
            "consistency_auditor.audit->orchestrator.pddl_fd"
        ]
    }
}