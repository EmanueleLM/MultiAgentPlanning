{
    "name": "Blocksworld7",
    "author": "Human",
    "agents": {
        "number": 3,
        "names": [
            "spec_parser",
            "causal_auditor",
            "orchestrator"
        ],
        "spec_parser": {
            "private_information": [
                "Understands standard Blocksworld semantics and can normalize synonyms (pick up -> pickup, put down -> putdown, stack on top of -> stack, unstack from on top of -> unstack).",
                "Will not invent objects, predicates, or initial facts that are not present; if information is missing, leave the relevant arrays empty."
            ],
            "goal": "Extract a clean, symbolic specification of the Blocks World from the public description, including objects, predicates, action schemas, and scenarios."
        },
        "causal_auditor": {
            "private_information": [
                "Focuses on temporal and causal consistency with STRIPS-style preconditions and effects.",
                "Removes bookkeeping shortcuts such as token budgets, post-hoc penalties, or implicit state changes; every change must be justified by an action effect.",
                "Prefers minimal repairs that make the plan applicable at each step."
            ],
            "goal": "Audit, validate, and, if necessary, minimally repair the provided plans so that each step is applicable under the model and constraints."
        },
        "orchestrator": {
            "private_information": [
                "Coordinates other agents and is responsible for producing the final PDDL domain and problem targeting the Fast Downward solver.",
                "Keeps action names and predicate set consistent with canonical Blocksworld."
            ],
            "goal": "Integrate the parsed specification and audited results to emit a final PDDL domain and a single PDDL problem for the selected scenario, compatible with Fast Downward."
        }
    },
    "environment": {
        "init": {
            "domain": "blocksworld",
            "target_scenario": "scenario_1",
            "visibility": "global"
        },
        "public_information": [
            "You are in a blocks world with primitive actions: pickup, unstack, putdown, stack.",
            "Action constraints: (1) Only one block can be picked up or unstacked at a time; (2) You can pickup or unstack only if the hand is empty; (3) You can pickup a block only if it is on the table and clear; (4) You can unstack a block from another only if it was indeed on top of the other and it is clear; (5) After a pickup or unstack you are holding that block; (6) You can putdown only if you are holding a block; (7) You can stack only if you are holding the block and the destination block is clear; (8) After a putdown or stack, the hand becomes empty; (9) After stacking onto a block, that destination block is no longer clear.",
            "Scenario 1 initial facts: clear(red), clear(blue), clear(yellow), handempty, on(blue,orange), ontable(red), ontable(orange), ontable(yellow).",
            "Scenario 1 goal: on(red,blue), on(blue,yellow), on(yellow,orange).",
            "Scenario 1 provided plan (natural language): unstack the blue block from on top of the orange block; stack the blue block on top of the red block; pick up the yellow block; stack the yellow block on top of the orange block; unstack the blue block from on top of the red block; stack the blue block on top of the yellow block; pick up the red block; stack the red block on top of the blue block.",
            "Scenario 2 initial facts: clear(blue), clear(orange), handempty, on(orange,yellow), on(yellow,red), ontable(red), ontable(blue).",
            "Scenario 2 goal: on(red,orange), on(blue,red), on(yellow,blue).",
            "Scenario 2 plan: not provided."
        ],
        "scenarios": {
            "scenario_1": {
                "objects": [
                    "red",
                    "blue",
                    "yellow",
                    "orange"
                ],
                "initial_state": [
                    "clear(red)",
                    "clear(blue)",
                    "clear(yellow)",
                    "handempty",
                    "on(blue,orange)",
                    "ontable(red)",
                    "ontable(orange)",
                    "ontable(yellow)"
                ],
                "goal": [
                    "on(red,blue)",
                    "on(blue,yellow)",
                    "on(yellow,orange)"
                ],
                "plan": [
                    "unstack(blue,orange)",
                    "stack(blue,red)",
                    "pickup(yellow)",
                    "stack(yellow,orange)",
                    "unstack(blue,red)",
                    "stack(blue,yellow)",
                    "pickup(red)",
                    "stack(red,blue)"
                ]
            },
            "scenario_2": {
                "objects": [
                    "red",
                    "blue",
                    "yellow",
                    "orange"
                ],
                "initial_state": [
                    "clear(blue)",
                    "clear(orange)",
                    "handempty",
                    "on(orange,yellow)",
                    "on(yellow,red)",
                    "ontable(red)",
                    "ontable(blue)"
                ],
                "goal": [
                    "on(red,orange)",
                    "on(blue,red)",
                    "on(yellow,blue)"
                ],
                "plan": []
            }
        }
    },
    "workflow": {
        "spec_parser": {
            "extract_spec": {
                "input": [],
                "output": "parsed_spec",
                "system_prompt": "You are a domain analyst for Blocksworld. Extract a clean, symbol-level specification from natural language including objects, predicates, action signatures with STRIPS-style preconditions and effects, and scenarios (initial, goal, plan). Do not output PDDL.",
                "prompt": "Use the public information {environment->public_information} and any structured scenarios {environment->scenarios}. Normalize names: actions {pickup, putdown, stack, unstack}; predicates {on ?x ?y, ontable ?x, clear ?x, holding ?x, handempty}. Emit a compact JSON with keys: objects, predicates, actions, scenarios. Do not fabricate facts; if unknown, leave arrays empty."
            }
        },
        "causal_auditor": {
            "audit_and_normalize": {
                "input": [
                    "parsed_spec"
                ],
                "output": "audited_spec",
                "system_prompt": "You are a planning auditor focused on temporal and causal consistency. Remove bookkeeping shortcuts and ensure each step follows the model's preconditions and effects; apply minimal repairs when needed. Do not use token budgets, post-hoc penalties, or quota devices.",
                "prompt": "Audit the parsed specification {parsed_spec}. For each scenario: check action model well-formedness, validate the given plan, and return a corrected plan where each step is applicable. If a plan is missing, synthesize a valid plan if feasible; otherwise explain why. Output JSON with keys: model_summary, scenario_1_clean, scenario_1_notes, scenario_2_candidate, scenario_2_notes."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "parsed_spec",
                    "audited_spec"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert with PDDL and Fast Downward. Produce a PDDL domain and a PDDL problem file compatible with Fast Downward. Use STRIPS with typing. Provide the domain inside <domain></domain> and the problem inside <problem></problem> tags. Actions: pickup, putdown, stack, unstack. Predicates: on, ontable, clear, holding, handempty. Avoid functions, metrics, and derived predicates.",
                "prompt": "Integrate the parsed spec {parsed_spec} with the audited results {audited_spec}. Choose the scenario indicated by {environment->init->target_scenario}. If inconsistencies arise, prefer audited action semantics but use the chosen scenario's initial state and goals as facts. Do not include any plan in the PDDL problem. Declare objects as the blocks of the chosen scenario with type block. Emit exactly one domain and one problem targeting Fast Downward."
            }
        },
        "constraints": [
            "spec_parser.extract_spec->causal_auditor.audit_and_normalize",
            "spec_parser.extract_spec->orchestrator.pddl",
            "causal_auditor.audit_and_normalize->orchestrator.pddl"
        ]
    }
}