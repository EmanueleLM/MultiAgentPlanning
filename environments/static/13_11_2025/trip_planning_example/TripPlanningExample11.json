{
    "name": "TripPlanningExample11",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "travel_planner",
            "flights_expert",
            "consistency_auditor",
            "orchestrator"
        ],
        "travel_planner": {
            "private_information": [
                "I prefer to minimize the number of city switches while respecting hard constraints such as required conference days and direct flight availability.",
                "If a start city is not specified, I will propose one that simplifies transfers given the flight graph."
            ],
            "goal": "Propose a 15-day city-by-day outline that respects direct flight connectivity and ensures presence in Valencia on days 9 and 15."
        },
        "flights_expert": {
            "private_information": [
                "Direct flights are bidirectional between Vienna and Valencia, and between Vilnius and Vienna.",
                "No direct flights exist between Vilnius and Valencia."
            ],
            "goal": "Validate that consecutive city transitions in the outline use only direct flights, and when needed, introduce a same-day transfer via Vienna while preserving daily atomicity."
        },
        "consistency_auditor": {
            "private_information": [
                "The requested stays sum to 17 days (Vienna 5, Vilnius 5, Valencia 7) but the horizon is 15 days; this is inconsistent and must be normalized.",
                "Days are atomic; a traveler cannot be in multiple cities on the same day; no teleportation; all city changes must be realized via allowed direct flights.",
                "Avoid bookkeeping shortcuts such as artificial tokens, quotas, or post-hoc penalties; produce explicit daily assignments and hard constraints."
            ],
            "goal": "Audit and normalize the requirements into a consistent 15-day schedule that preserves Valencia on days 9 and 15, uses only direct flights, and reconciles city-day targets with minimal deviation."
        },
        "orchestrator": {
            "private_information": [
                "Final output must be a PDDL domain and problem compatible with the Fast Downward solver (STRIPS with typing; avoid unsupported constructs).",
                "Model days as discrete objects with a successor relation; enforce conference attendance by requiring satisfaction on specific days in Valencia."
            ],
            "goal": "Integrate the outline, flight graph, and audited constraints, then produce a PDDL domain and problem that yields a valid 15-day plan using only direct flights and attending conferences on days 9 and 15 in Valencia."
        }
    },
    "environment": {
        "init": {
            "days": 15,
            "cities": [
                "vienna",
                "vilnius",
                "valencia"
            ],
            "day_labels": [
                "d1",
                "d2",
                "d3",
                "d4",
                "d5",
                "d6",
                "d7",
                "d8",
                "d9",
                "d10",
                "d11",
                "d12",
                "d13",
                "d14",
                "d15"
            ],
            "direct_flights": [
                [
                    "vienna",
                    "valencia"
                ],
                [
                    "valencia",
                    "vienna"
                ],
                [
                    "vilnius",
                    "vienna"
                ],
                [
                    "vienna",
                    "vilnius"
                ]
            ],
            "conferences": {
                "valencia": [
                    "d9",
                    "d15"
                ]
            }
        },
        "public_information": [
            "Trip length is 15 days labeled d1 through d15.",
            "Cities to visit are Vienna, Vilnius, and Valencia.",
            "You plan to stay 5 days in Vienna, 5 days in Vilnius, and 7 days in Valencia.",
            "Direct flights exist between Vienna and Valencia.",
            "Direct flights exist between Vilnius and Vienna.",
            "No other direct flights are available.",
            "You must be in Valencia on days d9 and d15 to attend a conference.",
            "Only one city can be occupied per day; flights are taken only between cities with direct connections."
        ]
    },
    "workflow": {
        "travel_planner": {
            "propose_itinerary": {
                "input": [],
                "output": "plan_outline",
                "system_prompt": "You are a meticulous trip planner who proposes day-by-day city assignments that respect a 15-day horizon, direct flight connectivity, and required conference days.",
                "prompt": "Your name is travel_planner. Use the public information {environment->public_information} and your goal {agents->travel_planner->goal}. Propose a concrete start city and a daily city assignment for d1..d15 that minimizes switches and ensures Valencia on d9 and d15 while using only direct connections or clearly marking a transfer via Vienna. Return a compact JSON with fields: start_city, daily_cities (map day->city), and a brief justification."
            }
        },
        "flights_expert": {
            "build_flight_graph": {
                "input": [
                    "plan_outline"
                ],
                "output": "flight_graph",
                "system_prompt": "You are an aviation expert who validates directness of consecutive-day transitions and produces an explicit flight graph and allowed transitions.",
                "prompt": "Your name is flights_expert. You will receive a proposed outline {plan_outline}. Using the public information {environment->public_information}, validate that each consecutive pair of cities is connected by a direct flight. If a consecutive pair lacks a direct connection, suggest a same-day or next-day routing via Vienna that keeps days atomic and does not invent non-existent flights. Return a JSON with fields: adjacency (list of allowed direct city pairs), validated_transitions (list of day-to-day city pairs with flags direct_or_via_vienna), and notes."
            }
        },
        "consistency_auditor": {
            "audit_constraints": {
                "input": [
                    "plan_outline",
                    "flight_graph"
                ],
                "output": "temporal_audit",
                "system_prompt": "You audit temporal and causal consistency, forbid bookkeeping shortcuts, and normalize over-constrained requirements into a precise 15-day daily assignment.",
                "prompt": "Your name is consistency_auditor. Audit the outline {plan_outline} with the flight graph {flight_graph} and the public information {environment->public_information}. Resolve the 17-day vs 15-day conflict by preserving Valencia on d9 and d15 and minimizing deviation from the requested stays, favoring Vienna 5 days and Valencia 7 days and reducing Vilnius as needed. Ensure only direct flights are used, routing via Vienna where necessary. Produce normalized hard constraints as JSON with fields: start_city, daily_cities (d1..d15), city_day_targets (list of {city, days}), hard_rules (list), and justification."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "plan_outline",
                    "flight_graph",
                    "temporal_audit"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert with multi-agent PDDL planning targeting the Fast Downward solver; produce a STRIPS-typed PDDL domain and problem that encode days as objects with a successor relation, cities and direct flights, and requirements from the audit; always enclose outputs in <domain></domain> and <problem></problem> tags.",
                "prompt": "Integrate the outline {plan_outline}, the flight graph {flight_graph}, and the normalized constraints {temporal_audit}. Build a PDDL domain with types city and day; predicates at(?c - city), current_day(?d - day), next(?d - day ?d2 - day), direct(?c - city ?c2 - city), need(?d - day ?c - city), satisfied(?d - day); actions stay to advance day without changing city, fly to advance day and change city only if direct, and mark to satisfy the need for the current day; avoid unsupported features and keep to STRIPS with typing. Build a PDDL problem with cities {environment->init->cities}, days {environment->init->day_labels}, direct flights {environment->init->direct_flights}, successor relation over days, initial state using the start_city and day d1 from the audit, and need facts for each day-city from the audit. Set goals to have all satisfied(d1..d15) true and to be at day d15. Return only the PDDL domain and problem enclosed in <domain></domain> and <problem></problem> tags."
            }
        },
        "constraints": [
            "travel_planner.propose_itinerary->flights_expert.build_flight_graph",
            "flights_expert.build_flight_graph->consistency_auditor.audit_constraints",
            "consistency_auditor.audit_constraints->orchestrator.pddl"
        ]
    }
}