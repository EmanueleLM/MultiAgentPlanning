{
    "name": "TripPlanningExample12",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "traveler",
            "flight_planner",
            "temporal_auditor",
            "orchestrator"
        ],
        "traveler": {
            "private_information": [
                "I will travel for exactly 15 days in total.",
                "I only take direct flights between cities.",
                "I would like to spend 5 days in Valencia, 5 days in Amsterdam, and 7 days in Tallinn.",
                "I want to meet a friend in Tallinn between day 9 and day 15 inclusive."
            ],
            "goal": "State clear hard constraints and soft preferences for a 15-day trip visiting Amsterdam, Valencia, and Tallinn, and propose day allocations that fit the 15-day limit while respecting the friend meeting window and direct-flight-only rule."
        },
        "flight_planner": {
            "private_information": [
                "Direct flights exist between Amsterdam and Tallinn, and between Valencia and Amsterdam.",
                "Only direct flights are allowed; no layovers or multi-hop transfers."
            ],
            "goal": "Provide a direct-flight connectivity map and propose feasible city sequences that respect direct-flight connectivity and can support a 15-day contiguous itinerary."
        },
        "temporal_auditor": {
            "private_information": [
                "I audit temporal and causal consistency across constraints, route feasibility, and day allocations.",
                "I remove bookkeeping shortcuts such as quota tokens, post-hoc penalties, or retroactive scoring that do not correspond to actual actions or states in the world model."
            ],
            "goal": "Detect and resolve conflicts between preferences and hard rules, enforce the 15-day limit, ensure the friend meeting window is satisfied, and return a single coherent set of audited constraints and a feasible itinerary blueprint."
        },
        "orchestrator": {
            "private_information": [],
            "goal": "Integrate all inputs and produce a final PDDL domain and problem suitable for the Fast Downward solver that encodes the 15-day trip with direct flights and the Tallinn friend meeting requirement."
        }
    },
    "environment": {
        "init": {
            "total_days": 15,
            "day_range": [
                1,
                15
            ],
            "cities": [
                "Amsterdam",
                "Valencia",
                "Tallinn"
            ],
            "direct_flights": [
                {
                    "from": "Amsterdam",
                    "to": "Tallinn"
                },
                {
                    "from": "Tallinn",
                    "to": "Amsterdam"
                },
                {
                    "from": "Valencia",
                    "to": "Amsterdam"
                },
                {
                    "from": "Amsterdam",
                    "to": "Valencia"
                }
            ],
            "transfer_policy": "direct_only",
            "time_units": "days"
        },
        "public_information": [
            "The trip spans exactly 15 consecutive days numbered 1 to 15.",
            "Cities to visit: Amsterdam, Valencia, and Tallinn.",
            "Only direct flights are allowed between cities.",
            "Direct flights exist between Amsterdam and Tallinn, and between Valencia and Amsterdam.",
            "Preferred durations: Valencia 5 days, Amsterdam 5 days, Tallinn 7 days. These are preferences and may be relaxed if needed to satisfy hard constraints.",
            "You want to meet a friend in Tallinn on at least one day between day 9 and day 15 inclusive.",
            "The itinerary is contiguous; each day is assigned to exactly one city, and any city change happens via a direct flight at the day boundary."
        ]
    },
    "workflow": {
        "traveler": {
            "preferences": {
                "input": [],
                "output": "traveler_preferences",
                "system_prompt": "You are a travel preference consolidator. Turn informal wishes and rules into a minimal and precise set of constraints and soft preferences for planning. Identify hard constraints (exactly 15 days total, direct flights only, friend meeting window in Tallinn, contiguity of days) and soft preferences (desired days per city). Provide up to three candidate day allocations that sum to 15 and position the Tallinn segment so at least one day falls within days 9 to 15. Do not produce PDDL.",
                "prompt": "Your name is traveler. Public information: {environment->public_information}. Your private knowledge: {agents->traveler->private_information}. Global goal: {agents->traveler->goal}. Produce a compact summary of hard constraints and soft preferences, plus up to three candidate allocations across the three cities that sum to 15. Make the output easy to integrate by other agents. Do not produce PDDL."
            }
        },
        "flight_planner": {
            "direct_routes": {
                "input": [],
                "output": "flight_graph",
                "system_prompt": "You are a flight connectivity expert. From the list of cities and direct flights, produce a symmetric adjacency mapping of allowed direct moves and list rejected transitions that would require layovers. Do not assume any flights not explicitly stated. Do not produce PDDL.",
                "prompt": "Your name is flight_planner. Use environment initialization data and public information to build the direct-flight graph. Cities: {environment->init->cities}. Direct flights: {environment->init->direct_flights}. Transfer policy: {environment->init->transfer_policy}. Output a clear connectivity map and note any non-direct transitions as infeasible. Do not produce PDDL."
            },
            "sequence_candidates": {
                "input": [
                    "traveler_preferences",
                    "flight_graph"
                ],
                "output": "route_candidates",
                "system_prompt": "You design feasible city sequences that respect direct-flight connectivity. Using the flight graph and the traveler preferences, propose one to three ordered city sequences that visit the three cities, ensuring each consecutive pair is connected by a direct flight. For each sequence, suggest day ranges per city that sum to 15 and place Tallinn so at least one day is between day 9 and day 15. Do not produce PDDL.",
                "prompt": "Your name is flight_planner. You will receive traveler preferences and the direct-flight graph. Inputs: {traveler_preferences} and {flight_graph}. Propose 1 to 3 feasible ordered city sequences and day-range suggestions that honor connectivity and the friend meeting window. Label any assumptions explicitly and avoid fabricating flights. Do not produce PDDL."
            }
        },
        "temporal_auditor": {
            "audit": {
                "input": [
                    "traveler_preferences",
                    "flight_graph",
                    "route_candidates"
                ],
                "output": "audited_constraints",
                "system_prompt": "You are a temporal and causal consistency auditor. Check that day allocations sum exactly to 15, that direct-flight-only constraints are respected, and that the Tallinn friend meeting window is satisfied. Detect contradictions such as total preferred days exceeding 15 and reconcile them by prioritizing hard constraints first and then maximizing soft preference satisfaction, without introducing bookkeeping shortcuts such as quota tokens, post-hoc penalties, or retroactive scoring. Produce a single audited constraints object with a chosen feasible sequence, concrete day spans for each city, and a brief justification. Do not produce PDDL.",
                "prompt": "Your name is temporal_auditor. You will receive traveler preferences, the flight graph, and sequence candidates. Inputs: {traveler_preferences}, {flight_graph}, and {route_candidates}. Return an audited and reconciled constraint set that is fully consistent, including the chosen city order, day spans per city summing to 15, and assurance that Tallinn includes at least one day in the range 9 to 15. Also return a short explanation of any relaxed preferences. Do not produce PDDL."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "audited_constraints",
                    "flight_graph",
                    "route_candidates",
                    "traveler_preferences"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert in classical PDDL modeling for the Fast Downward planner. Produce one PDDL domain and one PDDL problem, enclosed in <domain></domain> and <problem></problem> tags. Target Fast Downward compatibility by using STRIPS with typing and avoiding numeric fluents; model days as discrete objects d1..d15 and define a successor relation to represent day progression. Encode only direct flights using a predicate direct(a,b); use actions to fly between directly connected cities at day boundaries and to stay in a city to advance the day. Encode a requirement that at least one day spent in Tallinn occurs between days 9 and 15 inclusive. Ensure the plan spans exactly 15 days with contiguous day advancement and exactly one city per day. Use the city names from the inputs. Do not include Markdown or explanations; only return the PDDL content inside the required tags.",
                "prompt": "You are the orchestrator. Integrate the following inputs to build a consistent trip-planning model and instance: audited constraints: {audited_constraints}; flight graph: {flight_graph}; sequence candidates: {route_candidates}; traveler preferences: {traveler_preferences}. Produce a final PDDL domain and problem suitable for Fast Downward that enforces exactly 15 days, allows only direct flights, and encodes the friend meeting requirement in Tallinn between days 9 and 15. Return only the PDDL enclosed in <domain></domain> and <problem></problem>."
            }
        },
        "constraints": [
            "traveler.preferences->flight_planner.sequence_candidates",
            "flight_planner.direct_routes->flight_planner.sequence_candidates",
            "traveler.preferences->temporal_auditor.audit",
            "flight_planner.direct_routes->temporal_auditor.audit",
            "flight_planner.sequence_candidates->temporal_auditor.audit",
            "temporal_auditor.audit->orchestrator.pddl",
            "flight_planner.direct_routes->orchestrator.pddl",
            "traveler.preferences->orchestrator.pddl"
        ]
    }
}