{
    "name": "TripPlanningExample14",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "city_planner",
            "flight_planner",
            "auditor",
            "orchestrator"
        ],
        "city_planner": {
            "private_information": [
                "Hard requirements: 10 total days, attend the Krakow show on days 8-10, only use direct flights, one city per day.",
                "Preferences: 7 days in Lyon (high priority), 3 days in Krakow (aligned with the show), 2 days in Frankfurt (soft).",
                "Must visit all three cities without bookkeeping shortcuts; a visit requires allocating at least one full day in that city."
            ],
            "goal": "Propose a feasible day-by-day itinerary that attends the Krakow show on days 8-10, uses only direct flights, and distributes the 10 days across Lyon, Frankfurt, and Krakow; if all preferences cannot be satisfied simultaneously, prioritize feasibility and show attendance, then maximize days in Lyon, then days in Frankfurt."
        },
        "flight_planner": {
            "private_information": [
                "Direct flights are only available between the following city pairs and are bidirectional: Lyon <-> Frankfurt, Frankfurt <-> Krakow.",
                "No direct flight exists between Lyon and Krakow; travel between them must connect via Frankfurt."
            ],
            "goal": "Provide the direct flight adjacency and at least one feasible inter-city transition pattern that respects the 10-day horizon and any candidate itinerary."
        },
        "auditor": {
            "private_information": [
                "Audit rules: no teleportation, no overlapping or double-counted days, exactly one city per day, only direct flights allowed between consecutive days if city changes.",
                "Remove bookkeeping shortcuts: layovers do not count as additional city-days, and a city is considered visited only if at least one full day is allocated there.",
                "Conflict handling policy: keep feasibility and show attendance as hard constraints; require visiting all three cities; then maximize days in Lyon; remaining days go to Frankfurt up to the 2-day preference; provide an explicit nearest-feasible target itinerary when preferences conflict."
            ],
            "goal": "Evaluate proposals and flight connectivity for temporal and causal consistency, identify any infeasibilities, and return a normalized set of hard constraints and a nearest-feasible 10-day itinerary that visits all three cities, attends the Krakow show on days 8-10, and avoids bookkeeping shortcuts."
        },
        "orchestrator": {
            "private_information": [
                "You coordinate the agents and compile the final PDDL artifacts.",
                "Target solver: FastDownward; produce classical PDDL (typed) with a day-by-day progression model."
            ],
            "goal": "Integrate the proposal, flight connectivity, and audit to produce a final PDDL domain and problem that enforces all audited hard constraints and encodes a concrete feasible 10-day itinerary; include comments noting which soft preferences are met or violated."
        }
    },
    "environment": {
        "init": {
            "total_days": 10,
            "start_city": "Lyon",
            "days_indexing": "1-based",
            "solver": "FastDownward"
        },
        "public_information": [
            "Trip duration: 10 consecutive days labeled 1..10.",
            "Cities to visit: Lyon, Frankfurt, Krakow.",
            "Direct flights exist only between the following bidirectional pairs: Lyon <-> Frankfurt, Frankfurt <-> Krakow.",
            "Attendance requirement: Be physically in Krakow on days 8, 9, and 10 for an annual show.",
            "Preference: Spend 7 days in Lyon.",
            "Preference: Spend 3 days in Krakow (aligned with show days 8-10).",
            "Preference: Would like to visit Frankfurt for 2 days.",
            "Movement rule: At most one city change per day, and only using a listed direct flight.",
            "Counting rule: Each day is assigned to exactly one city; layovers do not create extra days.",
            "Primary objective: Produce a feasible 10-day itinerary obeying direct-flight connectivity; if preferences conflict, prioritize feasibility and show attendance, then maximize days in Lyon, then days in Frankfurt."
        ]
    },
    "workflow": {
        "city_planner": {
            "proposal": {
                "input": [],
                "output": "proposal_city_plan",
                "system_prompt": "You specialize in transforming trip requirements into structured itineraries and constraints; analyze inputs and produce a clear, machine-readable proposal without generating PDDL.",
                "prompt": "Your name is city_planner. Public information: {environment->public_information}. Your knowledge: {agents->city_planner->private_information}. Goal: {agents->city_planner->goal}. Produce a structured JSON object with fields: hard_constraints, soft_preferences (ranked), and candidate_itinerary containing days_by_city and a proposed city sequence over 10 days that respects direct flights only and places Krakow on days 8-10; if not all preferences fit within 10 days, prefer visiting all three cities, then maximize Lyon days, then Frankfurt days."
            }
        },
        "flight_planner": {
            "routes": {
                "input": [],
                "output": "flight_connectivity",
                "system_prompt": "You design minimal flight graphs and feasible transition patterns; provide connectivity and sample routes without generating PDDL.",
                "prompt": "Your name is flight_planner. Public information: {environment->public_information}. Your knowledge: {agents->flight_planner->private_information}. Goal: {agents->flight_planner->goal}. Return a JSON object with: adjacency (bidirectional direct-flight edges), and a feasible transition_pattern that can connect the cities over 10 days consistent with direct flights and any candidate itinerary, avoiding assumptions about unlisted routes."
            }
        },
        "auditor": {
            "audit": {
                "input": [
                    "proposal_city_plan",
                    "flight_connectivity"
                ],
                "output": "audited_constraints",
                "system_prompt": "You audit temporal and causal consistency, eliminate bookkeeping shortcuts, and resolve conflicts by prioritizing feasibility and show attendance; output normalized constraints and a nearest-feasible target itinerary; do not generate PDDL.",
                "prompt": "Your name is auditor. Public information: {environment->public_information}. Your knowledge: {agents->auditor->private_information}. Evaluate the proposal and routes: {proposal_city_plan} and {flight_connectivity}. Output JSON with: feasibility_status, conflict_explanation (if any), hard_constraints (normalized), soft_preferences (ranked), and target_itinerary detailing an exact day-by-day assignment over days 1..10 that visits all three cities, attends the Krakow show on days 8-10, uses only direct flights between consecutive days when changing cities, assigns exactly one city per day, and removes bookkeeping shortcuts. If strict preferences conflict, choose the nearest-feasible plan maximizing days in Lyon and then Frankfurt."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "proposal_city_plan",
                    "flight_connectivity",
                    "audited_constraints"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert multi-agent coordinator who synthesizes a final classical PDDL domain and problem targeting the FastDownward solver. You always provide a PDDL domain and a PDDL problem, enclosed in <domain></domain> and <problem></problem>. Model 10 discrete days with a next relation, three cities, bidirectional direct-flight edges, and day-by-day actions that either stay or fly to the next city, advancing the day. Enforce the audited hard constraints, including: exactly one city per day, direct flights only when changing cities between consecutive days, attendance in Krakow on days 8, 9, and 10, and visiting all three cities. Encode the concrete target itinerary from the audit as explicit goal conditions so a plan exists and is unique up to action choices. Add comments indicating which soft preferences (e.g., 7 Lyon days, 2 Frankfurt days) are met or violated. Keep actions and predicates simple and compatible with FastDownward (typed PDDL).",
                "prompt": "Inputs to integrate: Proposal: {proposal_city_plan}. Flight graph: {flight_connectivity}. Audited constraints and target itinerary: {audited_constraints}. Produce the final PDDL domain and problem that achieve the audited target itinerary over exactly 10 days. Ensure the domain contains types (city, day), predicates (at, current, next, assigned, visited, edge, spent_in_lyon, spent_in_frankfurt, spent_in_krakow, attend_d8, attend_d9, attend_d10), and actions stay_d(?d) and fly_d(?d ?from ?to) that advance the day along next; automatically mark spent_in_* for the city of the assigned day and mark attendance when in Krakow on days d8-d10. The problem should declare days d1..d10 and next chain, cities lyon, frankfurt, krakow with edges lyon<->frankfurt and frankfurt<->krakow, initial state with current d1 and at lyon, and goals that allocate all 10 days and match the audited target itinerary (e.g., Lyon on days 1-6, Frankfurt on day 7, Krakow on days 8-10) while meeting attendance and visit-all-three-cities requirements. Enclose outputs in <domain></domain> and <problem></problem> tags."
            }
        },
        "constraints": [
            "city_planner.proposal->auditor.audit",
            "flight_planner.routes->auditor.audit",
            "city_planner.proposal->orchestrator.pddl",
            "flight_planner.routes->orchestrator.pddl",
            "auditor.audit->orchestrator.pddl"
        ]
    }
}