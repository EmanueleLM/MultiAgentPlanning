{
    "name": "TripPlanningExample17",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "trip_planner",
            "flight_expert",
            "auditor",
            "orchestrator"
        ],
        "trip_planner": {
            "private_information": [
                "Expert in constructing day-by-day itineraries under hard constraints",
                "Prioritize: total 11 days, presence in Copenhagen on Day 1 and Day 5, only direct flights when changing cities",
                "If preferences conflict with hard constraints, adjust Vienna and Lyon durations while keeping 5 days in Copenhagen to cover the conference window"
            ],
            "goal": "Propose one or more feasible day-by-day itineraries that satisfy all hard rules and maximize adherence to preferences."
        },
        "flight_expert": {
            "private_information": [
                "Knows the direct-flight network among the cities",
                "Ensures that all city changes use only direct flights",
                "Identifies transfer requirements when no direct edge exists"
            ],
            "goal": "Provide a correct and minimal direct-flight connectivity map and validate that proposed itineraries respect it."
        },
        "auditor": {
            "private_information": [
                "Audits temporal and causal consistency across days and moves",
                "Eliminates bookkeeping shortcuts (no quota tokens, no post-hoc penalties, no implicit teleports or same-day multi-city hops unless explicitly modeled)",
                "Detects and repairs conflicts between preferences and hard constraints"
            ],
            "goal": "Validate and, if necessary, repair the itinerary so that it spans exactly 11 days, attends the Copenhagen conference on Day 1 and Day 5, and uses only direct flights between consecutive days."
        },
        "orchestrator": {
            "private_information": [
                "Coordinates the other agents' outputs",
                "Synthesizes the final PDDL domain and problem targeting the FastDownward solver"
            ],
            "goal": "Integrate the agents' inputs into a single coherent plan and produce a PDDL domain and problem that encode the 11-day trip with conference obligations and direct-flight constraints."
        }
    },
    "environment": {
        "init": {
            "total_days": 11,
            "days": [
                "d1",
                "d2",
                "d3",
                "d4",
                "d5",
                "d6",
                "d7",
                "d8",
                "d9",
                "d10",
                "d11"
            ],
            "cities": [
                "copenhagen",
                "vienna",
                "lyon"
            ],
            "direct_flights": [
                [
                    "copenhagen",
                    "vienna"
                ],
                [
                    "vienna",
                    "copenhagen"
                ],
                [
                    "vienna",
                    "lyon"
                ],
                [
                    "lyon",
                    "vienna"
                ]
            ]
        },
        "public_information": [
            "Trip duration is 11 consecutive days labeled Day 1 to Day 11.",
            "You must be in Copenhagen on Day 1 and Day 5 to attend a conference.",
            "You would like to spend 5 days in Copenhagen overall.",
            "You initially planned 4 days in Vienna and 4 days in Lyon, but the total must still be 11 days.",
            "Only direct flights are allowed when changing cities.",
            "Direct flights exist between Copenhagen and Vienna (both directions) and between Vienna and Lyon (both directions).",
            "There is no direct flight between Copenhagen and Lyon; transfers via Vienna are required."
        ]
    },
    "workflow": {
        "trip_planner": {
            "proposal": {
                "input": [],
                "output": "proposal_trip",
                "system_prompt": "You are a meticulous travel planner who produces clear, conflict-aware itineraries under hard constraints.",
                "prompt": "Your name is trip_planner. Use the following public information: {environment->public_information}. Your knowledge: {agents->trip_planner->private_information}. Global goal: {agents->orchestrator->goal}. Propose one or two feasible day-by-day itineraries for Day 1 through Day 11, listing the city for each day and indicating flight days between cities. Respect hard constraints: be in Copenhagen on Day 1 and Day 5 for the conference, use only direct flights between consecutive days, and span exactly 11 days. If Vienna and Lyon 4-day preferences conflict with the total duration or conference obligations, adjust them while keeping a total of 11 days and 5 days in Copenhagen. Provide a concise rationale for your choice and a canonical list of (Day, City) pairs."
            }
        },
        "flight_expert": {
            "flight_map": {
                "input": [],
                "output": "flight_map",
                "system_prompt": "You are an aviation and routing expert who validates connectivity and transfer requirements.",
                "prompt": "Your name is flight_expert. Use the following public information: {environment->public_information}. Produce the direct-flight adjacency you will enforce, explicitly listing allowed directed edges between cities and noting that Copenhagen and Lyon are not directly connected. State any implications for transfers. Provide simple rules for validating city changes between consecutive days."
            }
        },
        "auditor": {
            "audit": {
                "input": [
                    "proposal_trip",
                    "flight_map"
                ],
                "output": "audit_report",
                "system_prompt": "You audit temporal and causal consistency, removing bookkeeping shortcuts and repairing plans when needed.",
                "prompt": "Your name is auditor. You will validate the candidate itinerary against the flight_map. Check: exactly 11 days are present; Day 1 and Day 5 are in Copenhagen; all city changes occur between consecutive days and are allowed by the direct-flight map; no hidden tokens, no implicit multi-city same-day moves, and no retroactive fixes. If issues are found, produce a corrected itinerary that satisfies all hard constraints; when multiple feasible repairs exist, prefer keeping 5 total days in Copenhagen and splitting the remaining 6 days between Vienna and Lyon in a simple contiguous sequence achievable via available flights (for example, Copenhagen on Days 1-5, Vienna on Days 6-8, Lyon on Days 9-11). Output a short explanation and a canonical list of (Day, City) pairs."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "proposal_trip",
                    "flight_map",
                    "audit_report"
                ],
                "output": "pddl_final",
                "system_prompt": "You are an expert with PDDL targeting the FastDownward solver. You must output a PDDL domain and a PDDL problem enclosed in <domain></domain> and <problem></problem>. Use a simple STRIPS/ADL encoding with types (city, day) and predicates such as current(?d - day), next(?d1 - day ?d2 - day), at(?c - city), direct(?c1 - city ?c2 - city), visited(?c - city), conf_day(?d - day), and ready(?d - day). Provide actions: attend_conf (requires current(d), conf_day(d), at(copenhagen); effect sets ready(d)), stay (requires current(d), ready(d), at(c), next(d,d2); effect advances to d2 and keeps same city; add visited(c)), and fly (requires current(d), ready(d), at(c1), direct(c1,c2), next(d,d2); effect moves to d2 and changes to c2; add visited(c2)).",
                "prompt": "Integrate the itinerary signals: {proposal_trip}, the connectivity: {flight_map}, and the auditor validation: {audit_report}. Produce a final PDDL domain and problem suitable for FastDownward. Use objects: cities {copenhagen, vienna, lyon}; days d1..d11 with a linear next chain d1->d2->...->d11. Initialize: current d1; at copenhagen; visited copenhagen; conf_day d1 and d5; ready for all non-conference days (d2, d3, d4, d6, d7, d8, d9, d10, d11); direct edges exactly as in the flight map. Goal: current d11 and visited copenhagen, vienna, and lyon. This ensures attendance in Copenhagen on Day 1 and Day 5 because advancing from those days requires ready(d) set by attend_conf, which requires being at Copenhagen. Keep the domain general and problem-specific facts consistent; do not add extra cities or days; do not include metrics. Enclose the domain between <domain></domain> and the problem between <problem></problem> tags."
            }
        },
        "constraints": [
            "trip_planner.proposal->auditor.audit",
            "flight_expert.flight_map->auditor.audit",
            "trip_planner.proposal->orchestrator.pddl",
            "flight_expert.flight_map->orchestrator.pddl",
            "auditor.audit->orchestrator.pddl"
        ]
    }
}