{
    "name": "TripPlanningExample18",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "trip_planner",
            "flights_specialist",
            "temporal_auditor",
            "orchestrator"
        ],
        "trip_planner": {
            "private_information": [
                "I specialize in creating day-by-day itineraries that respect travel constraints and practical pacing.",
                "I prefer solutions that minimize unnecessary backtracking."
            ],
            "goal": "Draft candidate itineraries for an 11-day trip across Amsterdam, Vilnius, and Bucharest that align as much as possible with the desired stays and meet the social commitment window in Bucharest."
        },
        "flights_specialist": {
            "private_information": [
                "I enforce that only direct flights are allowed between cities.",
                "I validate itineraries against the explicit direct-flight graph and single-transition-per-day rule."
            ],
            "goal": "Construct the direct-flight graph and validate candidate itineraries to ensure every inter-city move is a permitted direct flight with at most one transition per day."
        },
        "temporal_auditor": {
            "private_information": [
                "I audit temporal and causal consistency and remove bookkeeping shortcuts such as quota tokens or post-hoc penalties.",
                "I surface infeasibilities early and resolve them by proposing minimal, transparent relaxations that become hard constraints."
            ],
            "goal": "Detect infeasible combinations of stay lengths, enforce day-by-day uniqueness in location, ensure the Bucharest meet window is satisfied, and produce a conflict-free, minimally-relaxed set of hard constraints for orchestration."
        },
        "orchestrator": {
            "private_information": [
                "I integrate multi-agent inputs and synthesize a final PDDL domain and problem suitable for the FastDownward solver.",
                "I encode the auditor\u2019s resolved constraints as hard constraints and ensure the model uses only direct flights with one transition per day."
            ],
            "goal": "Integrate the graph, audits, and validated itineraries to produce a final PDDL domain and problem that yields a feasible 11-day plan meeting the Bucharest friend window and the auditor\u2019s resolved stay targets."
        }
    },
    "environment": {
        "init": {
            "days_total": 11,
            "cities": [
                "Amsterdam",
                "Vilnius",
                "Bucharest"
            ],
            "target_stays": {
                "Amsterdam": 5,
                "Vilnius": 2,
                "Bucharest": 6
            },
            "direct_flights": [
                {
                    "from": "Amsterdam",
                    "to": "Bucharest"
                },
                {
                    "from": "Bucharest",
                    "to": "Amsterdam"
                },
                {
                    "from": "Vilnius",
                    "to": "Amsterdam"
                },
                {
                    "from": "Amsterdam",
                    "to": "Vilnius"
                }
            ],
            "friend_window": {
                "city": "Bucharest",
                "start_day": 6,
                "end_day": 11
            },
            "stay_or_fly_per_day": true,
            "max_flights_per_day": 1
        },
        "public_information": [
            "The total trip duration is 11 days.",
            "You intend to visit exactly three cities: Amsterdam, Vilnius, and Bucharest.",
            "Planned stays are Amsterdam 5 days, Vilnius 2 days, and Bucharest 6 days; these sum to 13 which exceeds 11, so they cannot all be met simultaneously.",
            "Only direct flights may be used to commute between cities.",
            "Direct flights exist between Amsterdam and Bucharest, and between Vilnius and Amsterdam (both directions).",
            "Exactly one transition per day is allowed: either stay in place for the next day or take exactly one direct flight.",
            "On each day you are in exactly one city.",
            "Friends are available in Bucharest between day 6 and day 11 inclusive, and you wish to meet them during that window.",
            "The start city is not specified and may be chosen by the planner; initialization must not violate the direct-flight rule when subsequent moves occur."
        ]
    },
    "workflow": {
        "trip_planner": {
            "analyze_requirements": {
                "input": [],
                "output": "requirements_summary",
                "system_prompt": "You are a travel itinerary designer who extracts structured requirements and identifies feasibility issues. Do not produce PDDL.",
                "prompt": "Summarize the trip requirements, the target stays, the total days, the direct-flight-only rule, and the Bucharest meet window using the following context: public={environment->public_information}, init={environment->init}. Identify infeasibilities such as 13 target days vs 11 available, and outline reasonable candidate distributions that could resolve the conflict while preserving Vilnius=2 and meeting the Bucharest window."
            },
            "propose_itineraries": {
                "input": [
                    "requirements_summary"
                ],
                "output": "candidate_itineraries",
                "system_prompt": "You produce concrete day-by-day candidate itineraries consistent with high-level requirements. Do not produce PDDL.",
                "prompt": "Using the summarized requirements and acknowledging that only direct flights are allowed, propose 2-3 day-by-day itineraries over 11 days that meet the Bucharest window and are as close as possible to the targets. Represent each itinerary as a list of 11 daily city assignments and mark days of flights explicitly between adjacent days. Do not include any city transitions that are not direct flights."
            }
        },
        "flights_specialist": {
            "build_flight_graph": {
                "input": [],
                "output": "flight_graph",
                "system_prompt": "You are an expert on flight networks and feasibility. Do not produce PDDL.",
                "prompt": "Build an undirected adjacency representation and edge list of direct flights from the environment initialization, ensuring only the following pairs are allowed: Amsterdam-Bucharest and Amsterdam-Vilnius. Provide both adjacency and edge list."
            },
            "validate_sequences": {
                "input": [
                    "candidate_itineraries",
                    "flight_graph"
                ],
                "output": "validated_itineraries",
                "system_prompt": "You validate itineraries against direct-flight constraints and one-transition-per-day rules. Do not produce PDDL.",
                "prompt": "Check each candidate itinerary to ensure that between consecutive days either the city is the same (stay) or the move is a single direct flight present in the flight_graph. Reject any itinerary that violates these rules and annotate valid ones with which days include flights."
            }
        },
        "temporal_auditor": {
            "audit_constraints": {
                "input": [
                    "requirements_summary",
                    "validated_itineraries"
                ],
                "output": "audit_report",
                "system_prompt": "You audit temporal and causal consistency, remove bookkeeping shortcuts, and propose minimal relaxations as hard constraints. Do not produce PDDL.",
                "prompt": "Perform a consistency audit over the 11-day horizon. Enforce one city per day, one transition per day, and meeting in Bucharest at least one day within days 6-11 inclusive. Acknowledge that the original target stays sum to 13>11 and therefore propose a minimal relaxation that becomes a hard constraint (for example, keeping Vilnius=2 and Bucharest=6 to satisfy the meet window, and reducing Amsterdam to 3, summing to 11). Produce a resolved set of hard constraints: exact stay counts per city summing to 11, day index bounds, and any additional structural requirements. Do not introduce quota tokens or post-hoc penalties; state counts must be enforced via explicit day allocations."
            }
        },
        "orchestrator": {
            "pddl_synthesis": {
                "input": [
                    "flight_graph",
                    "validated_itineraries",
                    "audit_report"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert with multi-agent PDDL problems targeting the FastDownward solver. You must produce a PDDL domain and a PDDL problem that encode days 1..11, mutually exclusive daily location, single transition per day (stay or one direct flight), the provided direct-flight graph, and the auditor\u2019s resolved hard constraints. Enclose the domain between <domain></domain> and the problem between <problem></problem> tags. Use discrete days with a next relation, a single traveler agent, and ensure the plan is solvable by FastDownward. Avoid commentary outside the tags.",
                "prompt": "Integrate the direct-flight graph, validated itineraries, and the auditor\u2019s hard constraints to synthesize a final PDDL domain and problem that yield at least one valid 11-day plan. The domain should define types for city and day, predicates for at(city, day) or equivalent day-indexed occupancy, next(day, day), and connectivity between cities for allowed flights. Include actions to choose an initial city on day 1, to stay from day d to next day, and to fly along a direct edge from day d to next day. Enforce exactly one city per day and at most one transition per day. Encode the auditor\u2019s resolved exact stay counts per city over the horizon and the requirement to be in Bucharest for at least one day within the window [6,11] as hard constraints in the problem (for example, by enumerating necessary day allocations or by auxiliary bookkeeping predicates that are driven only by explicit day assignments, not by quota tokens or post-hoc penalties). Target the FastDownward solver and ensure the domain and problem are enclosed in the required tags."
            }
        },
        "constraints": [
            "trip_planner.analyze_requirements->trip_planner.propose_itineraries",
            "flights_specialist.build_flight_graph->flights_specialist.validate_sequences",
            "trip_planner.propose_itineraries->flights_specialist.validate_sequences",
            "flights_specialist.validate_sequences->temporal_auditor.audit_constraints",
            "trip_planner.analyze_requirements->temporal_auditor.audit_constraints",
            "flights_specialist.build_flight_graph->orchestrator.pddl_synthesis",
            "flights_specialist.validate_sequences->orchestrator.pddl_synthesis",
            "temporal_auditor.audit_constraints->orchestrator.pddl_synthesis"
        ]
    }
}