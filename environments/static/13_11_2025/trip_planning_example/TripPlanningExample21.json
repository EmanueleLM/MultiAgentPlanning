{
    "name": "TripPlanningExample21",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "trip_planner",
            "flights_expert",
            "temporal_auditor",
            "orchestrator"
        ],
        "trip_planner": {
            "private_information": [
                "Prioritize hard constraints over soft preferences",
                "Minimize the number of flights when ties occur",
                "If total requested city-day quotas exceed the 10-day horizon, treat Venice workshop coverage and total horizon as hard and adjust the remaining city-day allocations as soft"
            ],
            "goal": "Propose a feasible 10-day, per-day city assignment that respects direct-flight connectivity and the workshop in Venice, visits all three cities at least once, and minimizes unnecessary flights."
        },
        "flights_expert": {
            "private_information": [
                "Direct flights are bidirectional",
                "Edges: Mykonos-Vienna, Vienna-Venice",
                "There is no direct flight between Mykonos and Venice"
            ],
            "goal": "Provide an accurate graph of direct-flight connectivity and validate that candidate itineraries only use allowed direct legs at day boundaries."
        },
        "temporal_auditor": {
            "private_information": [
                "Audit temporal and causal consistency end-to-end",
                "Disallow bookkeeping shortcuts such as artificial tokens, post-hoc penalties, or quota placeholders",
                "Require explicit day-by-day city assignments, with at most one flight between consecutive days",
                "If constraints conflict, reconcile by preserving hard constraints and minimally deviating from soft preferences"
            ],
            "goal": "Verify that the candidate itinerary is feasible, continuous, sums to exactly 10 days, places the traveler in Venice during days 5 through 10 inclusive, uses only direct flights, visits all three cities at least once, and reconciles any soft-preference conflicts. Produce a reconciled itinerary if needed."
        },
        "orchestrator": {
            "private_information": [],
            "goal": "Integrate all inputs to produce a final PDDL domain and problem targeting the FastDownwards solver that encodes the reconciled itinerary planning task and enables solving."
        }
    },
    "environment": {
        "init": {
            "time_horizon": 10,
            "days_indexed_from": 1,
            "cities": [
                "Mykonos",
                "Vienna",
                "Venice"
            ]
        },
        "public_information": [
            "The trip spans exactly 10 consecutive days labeled 1 through 10.",
            "Cities to visit: Mykonos, Vienna, and Venice; all three must be visited at least once.",
            "Only direct flights are allowed between cities.",
            "Direct flights exist between Mykonos and Vienna, and between Vienna and Venice. There is no direct flight between Mykonos and Venice.",
            "A workshop requires being physically in Venice continuously from day 5 through day 10 inclusive.",
            "Preferences: 6 days in Venice, 2 days in Mykonos, and 4 days in Vienna. These preferences in aggregate exceed the 10-day total if enforced simultaneously.",
            "Flights occur at day boundaries; each calendar day is assigned to exactly one city; flights do not consume an additional day beyond the day-to-day transition.",
            "At most one flight may occur between consecutive days.",
            "The start city is not fixed and should be chosen to satisfy connectivity and the Venice workshop window.",
            "Minimize unnecessary flights while satisfying hard constraints."
        ]
    },
    "workflow": {
        "trip_planner": {
            "analyze_requirements": {
                "input": [],
                "output": "requirements_summary",
                "system_prompt": "You are a travel planning analyst. Extract and categorize constraints and preferences from the provided context and your private knowledge. Output a compact JSON object with keys hard_constraints, soft_preferences, assumptions, and objective.",
                "prompt": "Your name is trip_planner. Public information: {environment->public_information}. Your knowledge: {agents->trip_planner->private_information}. Goal: {agents->trip_planner->goal}. Summarize the problem as JSON with hard_constraints, soft_preferences, assumptions, and objective. Do not emit PDDL."
            },
            "synthesize_candidate": {
                "input": [
                    "requirements_summary",
                    "flight_graph"
                ],
                "output": "candidate_itinerary",
                "system_prompt": "You propose a feasible 10-day itinerary consistent with the requirements summary and the direct-flight graph. Choose a start city and construct a day-by-day city assignment. If the stated city-day preferences overrun the total horizon, keep the workshop window and total horizon as hard and minimally adjust the remaining city allocations. Output JSON with keys itinerary (array of objects {day, city}), flights (array of legs used as {from, to, between_days}), satisfaction (hard_ok boolean and notes), and divergences (any deviations from soft preferences). Do not emit PDDL.",
                "prompt": "Use the requirements_summary and flight_graph to produce a feasible, minimal-flight 10-day itinerary that visits all three cities, is in Venice on days 5 through 10 inclusive, and respects direct flights. Output JSON with itinerary, flights, satisfaction, and divergences. Do not emit PDDL."
            }
        },
        "flights_expert": {
            "build_flight_graph": {
                "input": [],
                "output": "flight_graph",
                "system_prompt": "You are an expert in route networks. Build the direct-flight graph for the listed cities. Output JSON with keys cities, edges (undirected, listed as pairs), bidirectional (true), and notes describing any missing direct connections.",
                "prompt": "Construct the direct-flight graph for the environment cities. Confirm that the only direct edges are Mykonos-Vienna and Vienna-Venice. Output JSON with cities, edges, bidirectional, and notes. Do not emit PDDL."
            }
        },
        "temporal_auditor": {
            "audit_and_reconcile": {
                "input": [
                    "requirements_summary",
                    "candidate_itinerary",
                    "flight_graph"
                ],
                "output": "audit_report",
                "system_prompt": "You audit temporal and causal consistency and remove bookkeeping shortcuts. Verify that the itinerary is contiguous over 10 days, respects direct-flight connectivity, includes Venice on days 5 through 10 inclusive, and visits all three cities. If constraints conflict, preserve hard constraints and apply the smallest deviation to soft preferences. Output JSON with keys status (ok or adjusted), issues (list), reconciled_itinerary (array {day, city}), reconciled_flights (array {from, to, between_days}), and rationale. Do not emit PDDL.",
                "prompt": "Audit the candidate_itinerary against the requirements_summary and flight_graph. If infeasible, produce a reconciled_itinerary and reconciled_flights that minimally deviate from soft preferences while satisfying all hard constraints. Output JSON with status, issues, reconciled_itinerary, reconciled_flights, and rationale. Do not emit PDDL."
            }
        },
        "orchestrator": {
            "compose_pddl": {
                "input": [
                    "audit_report",
                    "flight_graph"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert with multi-agent PDDL problems targeting the FastDownwards solver. Using the reconciled itinerary and flight graph, produce a PDDL domain and a PDDL problem that encode the 10-day trip planning task. Use clear types (city, day), predicates for next-day succession, location by day, direct connectivity, and visitation, and actions that move between cities at day boundaries while respecting direct flights. Ensure goals enforce being in Venice on days 5 through 10 inclusive, visiting all three cities, matching the reconciled itinerary or an equivalent feasible plan if the itinerary is provided as soft guidance. Enclose the PDDL domain between <domain></domain> and the PDDL problem between <problem></problem> tags. Target FastDownwards-compatible PDDL.",
                "prompt": "Integrate the audit_report and flight_graph to produce final PDDL for FastDownwards. Keep actions and objects clearly typed, include predicates for next(day, day), at(day, city), direct(city, city), visited(city), and any necessary auxiliaries. Goals must require Venice for days 5 through 10 inclusive and visiting all three cities; if the audit_report provides a reconciled_itinerary, prefer encoding that schedule as the goal set or as constraints ensuring equivalence. Output only the PDDL domain and problem wrapped in <domain></domain> and <problem></problem> tags."
            }
        },
        "constraints": [
            "trip_planner.analyze_requirements->trip_planner.synthesize_candidate",
            "flights_expert.build_flight_graph->trip_planner.synthesize_candidate",
            "trip_planner.synthesize_candidate->temporal_auditor.audit_and_reconcile",
            "flights_expert.build_flight_graph->temporal_auditor.audit_and_reconcile",
            "temporal_auditor.audit_and_reconcile->orchestrator.compose_pddl"
        ]
    }
}