{
    "name": "TripPlanningExample27",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "itinerary_planner",
            "flight_checker",
            "time_auditor",
            "orchestrator"
        ],
        "itinerary_planner": {
            "private_information": [
                "I can draft city-by-day itineraries over a fixed horizon and reconcile hard vs soft requirements.",
                "I assume days are indexed from 1 to the planning horizon and that flights occur when changing cities between adjacent days."
            ],
            "goal": "Propose a 14-day, city-by-day itinerary over Amsterdam, Santorini, and Istanbul that respects hard requirements (Santorini on days 12-14 for 3 days total, Amsterdam for 7 days total) and aligns soft preferences as much as possible, using only allowed direct flights (connections via Amsterdam if necessary)."
        },
        "flight_checker": {
            "private_information": [
                "I know the direct flight network between the cities.",
                "I verify that every city transition in the candidate itinerary is achievable using only direct flights, and if not, I propose a same-day or adjacent-day connection through allowed edges without inventing new routes."
            ],
            "goal": "Validate itinerary city transitions using only direct flights; identify when a connection via Amsterdam is required; provide a clean flight-leg sequence consistent with the day-by-day plan."
        },
        "time_auditor": {
            "private_information": [
                "I audit temporal and causal consistency, eliminate bookkeeping shortcuts, and reconcile conflicts by prioritizing hard constraints over soft preferences.",
                "I treat: hard constraints = total 14 days, Santorini on days 12-14 inclusive (3 days), Amsterdam total 7 days; soft preference = Istanbul for 6 days (reduce if necessary)."
            ],
            "goal": "Check that the itinerary uses exactly 14 days, satisfies hard constraints, and uses only permitted commutes; if infeasible, make minimal changes that preserve hard constraints and produce a consistent revised itinerary with justification."
        },
        "orchestrator": {
            "private_information": [
                "I integrate planning, validation, and auditing outputs and produce the final PDDL domain and problem.",
                "The final PDDL must be solvable by FastDownward."
            ],
            "goal": "Coordinate all agents and produce a final PDDL domain and problem for FastDownward that encodes the 14-day trip with city stays, direct-flight commutes, and day-indexed constraints."
        }
    },
    "environment": {
        "init": {
            "planning_horizon_days": 14,
            "cities": [
                "Amsterdam",
                "Santorini",
                "Istanbul"
            ],
            "direct_flights": [
                [
                    "Amsterdam",
                    "Santorini"
                ],
                [
                    "Santorini",
                    "Amsterdam"
                ],
                [
                    "Istanbul",
                    "Amsterdam"
                ],
                [
                    "Amsterdam",
                    "Istanbul"
                ]
            ]
        },
        "public_information": [
            "You will visit exactly 3 European cities for a total of 14 days: Amsterdam, Santorini, Istanbul.",
            "Only direct flights are allowed for each flight leg. There are direct flights between Amsterdam and Santorini, and between Istanbul and Amsterdam; there is no direct flight between Istanbul and Santorini.",
            "You would like to visit Santorini for 3 days and you plan to visit relatives there on days 12-14 inclusive (hard constraint).",
            "You plan to stay in Amsterdam for 7 days total (hard constraint).",
            "You would like to visit Istanbul for 6 days (soft preference, adjustable if necessary to meet the 14-day horizon and other hard constraints).",
            "A valid trip must assign exactly one city to each day from day 1 to day 14 and use permitted direct flights when changing cities between consecutive days."
        ]
    },
    "workflow": {
        "itinerary_planner": {
            "plan": {
                "input": [],
                "output": "candidate_itinerary",
                "system_prompt": "You are an expert travel itinerary planner. You produce a precise day-by-day city assignment over a fixed horizon using only direct flights for inter-city moves. You distinguish hard constraints from soft preferences and avoid hidden shortcuts such as skipping days or double-counting.",
                "prompt": "Your name is itinerary_planner. Consider the public information {environment->public_information}. Use your knowledge {agents->itinerary_planner->private_information}. Your objective is {agents->itinerary_planner->goal}. Produce a structured candidate itinerary mapping each day 1-14 to a city, list intended flight transitions between consecutive days, and note any assumptions or soft-preference compromises without emitting PDDL."
            }
        },
        "flight_checker": {
            "graph": {
                "input": [],
                "output": "flight_network",
                "system_prompt": "You are a route validation expert. You provide the allowed direct flight edges and rules to be used by other agents.",
                "prompt": "Your name is flight_checker. From the public information {environment->public_information}, produce the explicit directed edge list of allowed direct flights and any necessary notes about permitted connections (only via existing direct edges). Do not emit PDDL."
            },
            "validate": {
                "input": [
                    "candidate_itinerary",
                    "flight_network"
                ],
                "output": "flight_validation",
                "system_prompt": "You validate transitions against the given direct flight graph and propose compliant legs when a connection is needed via permitted cities.",
                "prompt": "Your name is flight_checker. Using {candidate_itinerary} and {flight_network}, verify each city change between consecutive days is supported by a direct flight. If a direct flight is missing, propose a connection plan that uses only allowed direct edges (e.g., via Amsterdam) and specify any day-level implications, keeping the same day count when feasible. Return a clear validation report and a connection-adjusted sequence of flight legs without emitting PDDL."
            }
        },
        "time_auditor": {
            "audit": {
                "input": [
                    "candidate_itinerary",
                    "flight_validation"
                ],
                "output": "temporal_audit",
                "system_prompt": "You are a temporal and causal consistency auditor. You enforce hard constraints, handle soft preferences, and prevent bookkeeping shortcuts.",
                "prompt": "Your name is time_auditor. Using the public information {environment->public_information}, the candidate plan {candidate_itinerary}, and the validation {flight_validation}, check that exactly 14 days are used, that Santorini occupies days 12-14 inclusive for exactly 3 days, that Amsterdam totals 7 days, and that all moves use only permitted direct flights or permitted connections via existing direct edges. If the plan is infeasible due to day-count conflicts (e.g., 16 vs 14), propose the minimal change set that preserves all hard constraints and yields a consistent 14-day itinerary; treat Istanbul duration as a soft preference subject to reduction. Return a concise audit report and the revised feasible 14-day itinerary if changes are needed. Do not emit PDDL."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "candidate_itinerary",
                    "flight_network",
                    "flight_validation",
                    "temporal_audit"
                ],
                "output": "pddl_final",
                "system_prompt": "You are an expert in compiling itineraries into PDDL for FastDownward. You always provide a PDDL domain and a PDDL problem file. You target classical planning compatible with FastDownward and avoid constructs it does not support by default. You enclose the PDDL domain between <domain></domain> tags and the PDDL problem between <problem></problem> tags.",
                "prompt": "Coordinate the agents to produce final PDDL targeting the FastDownward solver. Use {environment->public_information}, the candidate itinerary {candidate_itinerary}, the flight graph {flight_network}, the validation {flight_validation}, and the audit result {temporal_audit}. Encode a day-indexed planning problem with objects for cities and days 1..14; predicates such as at(day,city), next(day,day), direct(city,city); and actions to either remain in place or fly along allowed direct edges between consecutive days. Enforce hard constraints: exactly one city per day across 14 days, Santorini on days 12, 13, 14, exactly 3 days in Santorini, exactly 7 days in Amsterdam; incorporate any auditor-approved adjustments to Istanbul days (soft preference reconciled to fit 14 days, typically 4 days if Amsterdam=7 and Santorini=3). Ensure the initial state defines day sequencing and starting location consistent with the reconciled itinerary, and the goal ensures the full assignment over all days matches the feasible itinerary. Do not invent direct flights beyond those provided. Return the PDDL domain inside <domain></domain> and the PDDL problem inside <problem></problem>."
            }
        },
        "constraints": [
            "flight_checker.graph->flight_checker.validate",
            "itinerary_planner.plan->flight_checker.validate",
            "itinerary_planner.plan->time_auditor.audit",
            "flight_checker.validate->time_auditor.audit",
            "itinerary_planner.plan->orchestrator.pddl",
            "flight_checker.graph->orchestrator.pddl",
            "flight_checker.validate->orchestrator.pddl",
            "time_auditor.audit->orchestrator.pddl"
        ]
    }
}