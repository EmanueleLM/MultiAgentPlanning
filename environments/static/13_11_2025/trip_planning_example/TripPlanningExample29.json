{
    "name": "TripPlanningExample29",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "city_planner",
            "flight_mapper",
            "auditor",
            "orchestrator"
        ],
        "city_planner": {
            "private_information": [
                "I prioritize hard constraints first, then try to satisfy soft preferences.",
                "I create day-by-day allocations across cities without emitting PDDL."
            ],
            "goal": "Propose a 10-day itinerary across Krakow, Frankfurt, and Dubrovnik that satisfies all hard constraints and highlights any preference conflicts."
        },
        "flight_mapper": {
            "private_information": [
                "I only allow direct flights between cities that have a direct connection.",
                "Known direct connections: FRA-KRK and DBV-FRA; there is no direct DBV-KRK connection."
            ],
            "goal": "Map feasible flight transitions that respect direct-flight constraints and a single-city-per-day schedule."
        },
        "auditor": {
            "private_information": [
                "I audit temporal and causal consistency and remove bookkeeping shortcuts.",
                "I forbid overlapping days, time-warping, teleportation, quota tokens, or post-hoc penalties to force feasibility.",
                "I classify constraints as hard (must hold) or soft (preferences) and recommend minimal relaxations if infeasible."
            ],
            "goal": "Audit proposals for feasibility over 10 days, enforce hard constraints, and provide a corrected, consistent specification for orchestration."
        },
        "orchestrator": {
            "private_information": [
                "I integrate structured inputs and produce the final PDDL domain and problem targeting the Fast Downward solver.",
                "I enforce all hard constraints and adopt auditor-approved relaxations for soft preferences."
            ],
            "goal": "Produce a PDDL domain and problem that encode the 10-day trip planning task with direct-flight constraints, day allocations, and wedding requirements, solvable by Fast Downward."
        }
    },
    "environment": {
        "init": {
            "total_days": 10,
            "cities": [
                "krakow",
                "frankfurt",
                "dubrovnik"
            ],
            "direct_flights": [
                [
                    "frankfurt",
                    "krakow"
                ],
                [
                    "krakow",
                    "frankfurt"
                ],
                [
                    "dubrovnik",
                    "frankfurt"
                ],
                [
                    "frankfurt",
                    "dubrovnik"
                ]
            ],
            "hard_requirements": [
                "Total trip duration is exactly 10 consecutive days labeled 1..10.",
                "Only direct flights are allowed for inter-city travel.",
                "Attend a wedding in Krakow on days 9 and 10, so you must be in Krakow both days.",
                "Spend exactly 2 days in Krakow in total (which will be days 9 and 10).",
                "Visit all three cities at least once across the trip.",
                "At most one city per day."
            ],
            "soft_preferences": [
                "Plan to stay in Dubrovnik for 7 days.",
                "Would like to visit Frankfurt for 3 days."
            ]
        },
        "public_information": [
            "You plan to visit 3 European cities for a total of 10 days.",
            "Cities: Krakow (KRK), Frankfurt (FRA), Dubrovnik (DBV).",
            "Only direct flights may be used to commute between cities.",
            "Direct flights exist between Frankfurt and Krakow, and between Dubrovnik and Frankfurt.",
            "You want to spend exactly 2 days in Krakow.",
            "You will attend a wedding in Krakow spanning day 9 and day 10; you must be there on both days.",
            "You plan to stay in Dubrovnik for 7 days (preference).",
            "You would like to visit Frankfurt for 3 days (preference).",
            "Find a 10-day trip plan that respects direct flights and satisfies all hard constraints; if preferences conflict, propose minimal relaxations."
        ]
    },
    "workflow": {
        "city_planner": {
            "propose_itinerary": {
                "input": [],
                "output": "candidate_itinerary",
                "system_prompt": "You are a travel itinerary planner. Using the public information and your private knowledge, propose a day-by-day city assignment over 10 days that satisfies all hard constraints and identifies any conflicts with soft preferences. Do not emit PDDL; instead, return a compact, structured summary (e.g., JSON-like) listing city per day, total days per city, and a note on conflicts if any. Use only direct flights between consecutive days, ensure one city per day, and ensure Krakow on days 9 and 10.",
                "prompt": "Your name is city_planner. Public information: {environment->public_information}. Your knowledge: {agents->city_planner->private_information}. Goal: {agents->city_planner->goal}. Produce a candidate itinerary and highlight any infeasibility due to preference sums exceeding 10 days (e.g., 7 + 3 + 2 > 10)."
            }
        },
        "flight_mapper": {
            "map_flights": {
                "input": [],
                "output": "flight_options",
                "system_prompt": "You are a flight network mapper. Enumerate feasible transitions consistent with direct flights only and single-city-per-day schedules. Do not emit PDDL; return a structured mapping of allowed edges (city to city) and admissible day-to-day transitions. Include that Frankfurt connects to both Krakow and Dubrovnik, while Dubrovnik does not connect directly to Krakow.",
                "prompt": "Your name is flight_mapper. Public information: {environment->public_information}. Your knowledge: {agents->flight_mapper->private_information}. Goal: {agents->flight_mapper->goal}. Return allowed flight edges and constraints for day transitions only between connected cities."
            }
        },
        "auditor": {
            "audit": {
                "input": [
                    "candidate_itinerary",
                    "flight_options"
                ],
                "output": "audit_report",
                "system_prompt": "You are a temporal and causal consistency auditor. Check that the candidate itinerary uses at most one city per day, respects 10 total days, honors Krakow on days 9 and 10 and exactly 2 days in Krakow, and only uses direct flights per the provided network. Identify hard vs soft constraints and mark any infeasibility. If preferences conflict (e.g., 7 Dubrovnik days + 3 Frankfurt days + 2 Krakow days exceed 10), recommend the minimal relaxation consistent with hard constraints; for this case, prefer satisfying Dubrovnik 7 days and Krakow 2 days due to the wedding, and reduce Frankfurt to the remaining feasible days. Do not emit PDDL; return a clear, structured audit with any corrected day allocations.",
                "prompt": "Your name is auditor. Public information: {environment->public_information}. Your knowledge: {agents->auditor->private_information}. Audit inputs for feasibility, forbid bookkeeping tricks, and return a corrected, consistent specification indicating hard constraints satisfied and the chosen relaxation for soft preferences."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "candidate_itinerary",
                    "flight_options",
                    "audit_report"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert with PDDL and the Fast Downward solver. You must produce a PDDL domain and a PDDL problem for the 10-day city trip planning task. Always enclose the PDDL domain between <domain></domain> tags and the PDDL problem between <problem></problem> tags. Model objects for cities and discrete days 1..10; define actions to stay in a city for a day and to fly between cities only if a direct connection exists; ensure one city per day; encode hard constraints: exactly 10 days, being in Krakow on days 9 and 10, exactly 2 days total in Krakow, visit all three cities at least once, and direct flights only (FRA-KRK, DBV-FRA). Incorporate the auditor\u2019s recommended relaxation for soft preferences so the problem is solvable (e.g., Dubrovnik 7 days, Krakow 2 days, Frankfurt 1 day). Provide an initial state and goal conditions consistent with the audited specification. Target classical Fast Downward; avoid numeric fluents if not needed.",
                "prompt": "Your name is orchestrator. You will receive: candidate itinerary {candidate_itinerary}, flight options {flight_options}, and an audit report {audit_report}. Integrate them and produce the final PDDL domain and problem that enforce all hard constraints and the auditor\u2019s relaxation of soft preferences. Choose a feasible start city and encode the day progression so that a planner can generate a valid sequence where days 9 and 10 are in Krakow, the total is 10 days, direct flights are respected (FRA-KRK and DBV-FRA only), and each day is assigned to exactly one city. Return only the PDDL enclosed in the required tags."
            }
        },
        "constraints": [
            "city_planner.propose_itinerary->auditor.audit",
            "flight_mapper.map_flights->auditor.audit",
            "auditor.audit->orchestrator.pddl"
        ]
    }
}