{
    "name": "TripPlanningExample6",
    "author": "Human",
    "agents": {
        "number": 4,
        "names": [
            "traveler",
            "flight_expert",
            "auditor",
            "orchestrator"
        ],
        "traveler": {
            "private_information": [
                "Preference to minimize the number of flights and city switches",
                "If total requested days exceed the 8-day budget, prioritize meeting the conference obligation and the 4-day stay in Berlin, then allocate remaining days to Dubrovnik before Munich"
            ],
            "goal": "State clear preferences and hard constraints for an 8-day trip across Berlin, Munich, and Dubrovnik so that a feasible itinerary can be produced."
        },
        "flight_expert": {
            "private_information": [
                "Knows the direct flight graph between cities",
                "Will avoid proposing connections that are not direct"
            ],
            "goal": "Provide the direct-flight connectivity data, feasible routing implications, and helpful notes for commuting between the specified cities."
        },
        "auditor": {
            "private_information": [
                "Audits temporal and causal consistency across days and flights",
                "Flags over-subscription of days and proposes minimal relaxations that preserve hard constraints",
                "Removes bookkeeping shortcuts such as quota tokens, artificial currency, or post-hoc penalties and relies only on explicit calendar and flight constraints"
            ],
            "goal": "Check feasibility of the requested itinerary over 8 days with direct flights only, enforce being in Berlin on days 1 and 4, and suggest the smallest relaxation set when preferences conflict with the total duration."
        },
        "orchestrator": {
            "private_information": [],
            "goal": "Integrate preferences, flight connectivity, and the auditor's feasibility report to produce a final plan and the corresponding PDDL domain and problem for the FastDownwards solver."
        }
    },
    "environment": {
        "init": {
            "days": 8,
            "cities": [
                "Berlin",
                "Munich",
                "Dubrovnik"
            ],
            "direct_flights": [
                [
                    "Berlin",
                    "Munich"
                ],
                [
                    "Munich",
                    "Dubrovnik"
                ]
            ],
            "start_city": "Berlin",
            "max_flights_per_day": 1
        },
        "public_information": [
            "Trip length is exactly 8 days.",
            "Desired stays: Dubrovnik for 3 days, Berlin for 4 days, Munich for 3 days.",
            "Mandatory obligation: You must be in Berlin on day 1 and day 4 for a conference.",
            "You only take direct flights to commute between cities.",
            "Available direct flights: Berlin <-> Munich, Munich <-> Dubrovnik. There is no direct Berlin <-> Dubrovnik flight.",
            "Requested days sum to 10 which exceeds the 8-day limit; this requires relaxation of at least one desired duration."
        ]
    },
    "workflow": {
        "traveler": {
            "itinerary_preferences": {
                "input": [],
                "output": "preferences_json",
                "system_prompt": "You gather and restate trip requirements as structured data, distinguishing hard constraints from soft preferences and specifying objectives such as minimizing city switches and flights.",
                "prompt": "Your name is traveler. Use the following public information: {environment->public_information}. Provide a compact JSON object describing: 1) total_days, 2) hard_constraints with exact day and city requirements, 3) soft_preferences listing desired days per city with priorities, 4) objective_weights such as minimize_flights and minimize_switches, and 5) any assumptions you would accept to resolve conflicts. Do not emit PDDL; output only a small, self-contained JSON structure."
            }
        },
        "flight_expert": {
            "flight_graph": {
                "input": [],
                "output": "flight_graph_json",
                "system_prompt": "You are responsible for flight connectivity and routing facts. You only list direct flights and summarize routing implications.",
                "prompt": "Your name is flight_expert. Use the following public information: {environment->public_information}. Output a small JSON object containing: 1) cities, 2) undirected_edges listing direct flight pairs, 3) adjacency as a dictionary of city -> neighbors, 4) routing_notes clarifying that Berlin <-> Dubrovnik requires a connection via Munich, and 5) constraints such as max one flight per day if present in the environment. Do not emit PDDL; output only the JSON facts."
            }
        },
        "auditor": {
            "consistency_audit": {
                "input": [
                    "preferences_json",
                    "flight_graph_json"
                ],
                "output": "audit_report",
                "system_prompt": "You audit temporal and causal consistency. You forbid bookkeeping shortcuts and rely only on explicit day allocations and flight legs. You detect over-subscription and propose minimal relaxations while preserving hard constraints.",
                "prompt": "Your name is auditor. You will receive the traveler's preferences and the flight expert's graph. Task: 1) determine feasibility over 8 days with direct flights only and max one flight per day if specified, 2) ensure Berlin on day 1 and day 4, 3) if total requested days exceed 8, propose a minimal relaxation set; prioritize keeping Berlin = 4 days and conference days fixed, then allocate remaining days to Dubrovnik before Munich unless instructed otherwise, 4) produce a recommended day-by-day city assignment of length 8 consistent with the flight graph and per-day transition rules, 5) include the flight legs implied by transitions, and 6) provide a clear rationale and a checklist of constraints satisfied. Output a compact JSON with fields: status (feasible or infeasible), relaxations (what changed and why), recommended_itinerary (map day -> city), flights (ordered list of legs with day), and verification (list of satisfied constraints). Do not emit PDDL."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "preferences_json",
                    "flight_graph_json",
                    "audit_report"
                ],
                "output": "pddl_orchestrator",
                "system_prompt": "You are an expert planner. Produce the final PDDL domain and problem compatible with the FastDownwards solver. Enclose the domain between <domain></domain> and the problem between <problem></problem>. The domain should model days, cities, being-in-city per day, and move actions constrained by direct-flight adjacency and at most one move per day if specified. The problem should instantiate an 8-day horizon, initial location consistent with day 1 in Berlin, enforce day 4 in Berlin, encode soft preferences as comments and apply the auditor's recommended relaxations, and set goals to realize the recommended itinerary exactly. Keep the model simple (typed STRIPS with predicates like at ?d ?c, next ?d ?d2, connected ?c ?c2, moved ?d) so it runs in FastDownwards.",
                "prompt": "Integrate these inputs to construct the final plan model and instance: Traveler preferences: {preferences_json}. Flight graph: {flight_graph_json}. Auditor report: {audit_report}. Produce a PDDL domain and problem that encode the 8-day schedule with direct flights only and the auditor's recommended itinerary. Ensure the problem is solvable in FastDownwards. Enclose the PDDL domain between <domain></domain> and the PDDL problem between <problem></problem>."
            }
        },
        "constraints": [
            "traveler.itinerary_preferences->auditor.consistency_audit",
            "flight_expert.flight_graph->auditor.consistency_audit",
            "auditor.consistency_audit->orchestrator.pddl",
            "traveler.itinerary_preferences->orchestrator.pddl",
            "flight_expert.flight_graph->orchestrator.pddl"
        ]
    }
}