{
    "name": "ChildsnackExample2",
    "author": "Human",
    "agents": {
        "number": 3,
        "names": [
            "planner",
            "auditor",
            "orchestrator"
        ],
        "planner": {
            "private_information": [
                "I must use the provided PDDL templates and fill them based on the natural language description to create a solvable planning task."
            ],
            "goal": "Generate the complete PDDL domain and problem definition for the Child-Snack scenario."
        },
        "auditor": {
            "private_information": [
                "I must ensure the generated PDDL adheres strictly to the constraints provided in the natural language description.",
                "I verify that required resources (GF sandwiches for allergic children) are correctly modeled and served."
            ],
            "goal": "Audit the PDDL generated by the planner for temporal, causal, and resource consistency."
        },
        "orchestrator": {
            "private_information": [
                "I integrate the validated PDDL files to produce the final planning solution."
            ],
            "goal": "Produce the final, validated PDDL domain and problem file to solve the task using FastDownwards."
        }
    },
    "environment": {
        "init": {
            "planning_system": "FastDownwards",
            "required_output": "PDDL Domain and PDDL Problem"
        },
        "public_information": [
            {
                "description_type": "Domain NL",
                "content": "The child-snack domain is designed to plan the preparation and serving of sandwiches to children, some of whom have gluten allergies. The domain includes actions for making sandwiches with and without gluten, placing sandwiches on trays, moving trays between places, and serving the sandwiches to the children. The actions defined in this domain include: 1. make_sandwich_no_gluten: Preconditions: gluten-free bread and content available in the kitchen, sandwich must not already exist. Effect: gluten-free bread/content unavailable, gluten-free sandwich available in kitchen. 2. make_sandwich: Preconditions: bread and content available in the kitchen, sandwich must not already exist. Effect: bread/content unavailable, sandwich available in kitchen. 3. put_on_tray: Preconditions: sandwich is in kitchen, tray is at kitchen. Effect: sandwich is no longer in kitchen and is now on the tray. 4. serve_sandwich_no_gluten: Preconditions: child is allergic to gluten, waiting at a place, gluten-free sandwich on a tray at the same place. Effect: sandwich no longer on tray, child is served. 5. serve_sandwich: Preconditions: child is not allergic to gluten, waiting at a place, sandwich on a tray at the same place. Effect: sandwich no longer on tray, child is served. 6. move_tray: Precondition: tray is at the starting place. Effect: tray moves to destination place."
            },
            {
                "description_type": "Problem NL",
                "content": "Prepare and serve sandwiches to seven children. Initial state: 2 trays (tray1, tray2) at kitchen. 7 portions of bread (bread1-bread7) and content (content1-content7) in kitchen. GF bread: bread2, bread5. GF content: content6, content7. Allergic children: child4, child7. Non-allergic children: child1, child2, child3, child5, child6. Waiting at table1: child1, child2, child3, child5, child7. Waiting at table3: child4, child6. 10 sandwiches (sandw1-sandw10) do not exist yet. Goal: All seven children are served."
            },
            {
                "description_type": "PDDL Domain Template",
                "content": "(define (domain child-snack)\n  (:requirements :typing :equality)\n  (:types child bread-portion content-portion sandwich tray place)\n  (:constants kitchen - place)\n\n  (:predicates)\n\n  (:action make_sandwich_no_gluten\n    :parameters (?s - sandwich ?b - bread-portion ?c - content-portion)\n    :precondition ()\n    :effect ()\n  )\n\n  (:action make_sandwich\n    :parameters (?s - sandwich ?b - bread-portion ?c - content-portion)\n    :precondition ()\n    :effect ()\n  )\n\n  (:action put_on_tray\n    :parameters (?s - sandwich ?t - tray)\n    :precondition ()\n    :effect ()\n  )\n\n  (:action serve_sandwich_no_gluten\n    :parameters (?s - sandwich ?c - child ?t - tray ?p - place)\n    :precondition ()\n    :effect ()\n  )\n\n  (:action serve_sandwich\n    :parameters (?s - sandwich ?c - child ?t - tray ?p - place)\n    :precondition ()\n    :effect ()\n  )\n\n  (:action move_tray\n    :parameters (?t - tray ?p1 ?p2 - place)\n    :precondition ()\n    :effect ()\n  )\n)"
            },
            {
                "description_type": "PDDL Problem Template",
                "content": "; child-snack task with 7 children and 0.4 gluten factor \n; constant factor of 1.3\n; random seed: 101\n\n(define (problem prob-snack)\n  (:domain child-snack)\n  (:objects\n    child1 child2 child3 child4 child5 child6 child7 - child\n    bread1 bread2 bread3 bread4 bread5 bread6 bread7 - bread-portion\n    content1 content2 content3 content4 content5 content6 content7 - content-portion\n    tray1 tray2 - tray\n    table1 table2 table3 - place\n    sandw1 sandw2 sandw3 sandw4 sandw5 sandw6 sandw7 sandw8 sandw9 sandw10 - sandwich\n  )\n  (:init\n     (at tray1 kitchen)\n     (at tray2 kitchen)\n     (at_kitchen_bread bread1)\n     (at_kitchen_bread bread2)\n     (at_kitchen_bread bread3)\n     (at_kitchen_bread bread4)\n     (at_kitchen_bread bread5)\n     (at_kitchen_bread bread6)\n     (at_kitchen_bread bread7)\n     (at_kitchen_content content1)\n     (at_kitchen_content content2)\n     (at_kitchen_content content3)\n     (at_kitchen_content content4)\n     (at_kitchen_content content5)\n     (at_kitchen_content content6)\n     (at_kitchen_content content7)\n     (no_gluten_bread bread5)\n     (no_gluten_bread bread2)\n     (no_gluten_content content7)\n     (no_gluten_content content6)\n     (allergic_gluten child4)\n     (allergic_gluten child7)\n     (not_allergic_gluten child1)\n     (not_allergic_gluten child2)\n     (not_allergic_gluten child3)\n     (not_allergic_gluten child5)\n     (not_allergic_gluten child6)\n     (waiting child1 table1)\n     (waiting child2 table1)\n     (waiting child3 table1)\n     (waiting child4 table3)\n     (waiting child5 table1)\n     (waiting child6 table3)\n     (waiting child7 table1)\n     (notexist sandw1)\n     (notexist sandw2)\n     (notexist sandw3)\n     (notexist sandw4)\n     (notexist sandw5)\n     (notexist sandw6)\n     (notexist sandw7)\n     (notexist sandw8)\n     (notexist sandw9)\n     (notexist sandw10)\n  )\n  (:goal\n    (and\n     (served child1)\n     (served child2)\n     (served child3)\n     (served child4)\n     (served child5)\n     (served child6)\n     (served child7)\n    )\n  )\n)"
            }
        ]
    },
    "workflow": {
        "planner": {
            "pddl": {
                "input": [],
                "output": "pddl_draft",
                "system_prompt": "You are an expert PDDL generator tasked with formalizing a planning scenario. You must integrate the logic derived from the Natural Language description into the provided PDDL templates. You must always provide a PDDL domain and a PDDL problem file to solve the task. You always enclose the PDDL domain between <domain></domain> tags, and the PDDL problem between <problem></problem> tags.",
                "prompt": "You are the planner. You have access to the following information: \n1. Natural Language Domain Description: {environment->public_information[0]->content}\n2. Natural Language Problem Description: {environment->public_information[1]->content}\n3. PDDL Domain Template: {environment->public_information[2]->content}\n4. PDDL Problem Template: {environment->public_information[3]->content}\n\nTask: Based on the descriptions, complete the PDDL Domain Template by defining the necessary predicates and filling in the preconditions and effects for all actions, ensuring proper tracking of gluten status for sandwiches. Then, confirm the PDDL Problem Template accurately reflects the initial state and goal.\n\nRequired Predicates (to ensure fidelity to the required logic):\n- (sandwich_at_kitchen ?s - sandwich)\n- (on_tray ?s - sandwich ?t - tray)\n- (is_gluten_free ?s - sandwich)\n\nDerive the complete PDDL domain and problem. Enclose the pddl domain between <domain></domain> tags, and the pddl problem between <problem></problem> tags."
            }
        },
        "auditor": {
            "review": {
                "input": [
                    "pddl_draft"
                ],
                "output": "pddl_audit_report",
                "system_prompt": "You are an auditing agent specializing in PDDL validation. Your role is to ensure the generated PDDL domain logic correctly enforces critical constraints defined in the problem description, focusing on resource allocation and causality. Provide a concise critique (or approval) of the input PDDL.",
                "prompt": "Review the PDDL provided below, which describes the Child-Snack planning problem. The critical constraint is that 'serve_sandwich_no_gluten' must only be used for children with 'allergic_gluten' and requires a sandwich that has the property 'is_gluten_free'. 'serve_sandwich' must only be used for children with 'not_allergic_gluten' and requires a sandwich that is NOT 'is_gluten_free'.\n\nInput PDDL:\n{pddl_draft}\n\nAnalyze the domain definitions for 'make_sandwich_no_gluten', 'make_sandwich', 'serve_sandwich_no_gluten', and 'serve_sandwich'. State clearly if the PDDL successfully enforces that allergic children only receive GF sandwiches."
            }
        },
        "orchestrator": {
            "pddl": {
                "input": [
                    "pddl_draft",
                    "pddl_audit_report"
                ],
                "output": "pddl_final_solution",
                "system_prompt": "You are the final orchestrator. Your task is to verify the audit report and output the final PDDL solution confirmed by the preceding agents.",
                "prompt": "The planner generated a PDDL solution, and the auditor reviewed it.\n\nPlanner PDDL Output:\n{pddl_draft}\n\nAuditor Review:\n{pddl_audit_report}\n\nIf the audit report indicates the PDDL is correct and adheres to the allergy constraints, output the validated PDDL domain and problem as the final solution. If corrections are needed, explain why and provide the corrected version.\n\nOutput the final PDDL domain between <domain></domain> tags, and the PDDL problem between <problem></problem> tags."
            }
        },
        "constraints": [
            "planner.pddl->auditor.review",
            "auditor.review->orchestrator.pddl"
        ]
    }
}