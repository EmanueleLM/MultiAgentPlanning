{
    "name": "ChildsnackExample13",
    "author": "Human",
    "agents": {
        "number": 2,
        "names": [
            "orchestrator",
            "auditor"
        ],
        "orchestrator": {
            "private_information": [
                "You are tasked with generating a runnable PDDL environment from provided natural language specifications and templates."
            ],
            "goal": "Produce a complete, valid PDDL domain and problem file for the Child-Snack scenario targeting the FastDownwards solver."
        },
        "auditor": {
            "private_information": [
                "You are an expert PDDL auditor and must verify the temporal and causal consistency of the generated PDDL."
            ],
            "goal": "Audit the generated PDDL output for completeness, validity, and adherence to the natural language constraints."
        }
    },
    "environment": {
        "init": {
            "grid_size": 1,
            "visibility": 1
        },
        "public_information": [
            "The planning task is the Child-Snack domain.",
            "Domain Description Summary: Involves making sandwiches (regular or gluten-free), placing them on trays, moving trays, and serving children based on their gluten allergy status.",
            "Problem Description Summary: Serve 13 children (5 allergic, 8 not allergic) using 3 trays, starting with 13 portions of bread/content. All trays and ingredients start in the kitchen. Children are waiting at table1, table2, or table3. 17 placeholders for sandwiches exist. Goal: all 13 children served.",
            "Predicates required based on NL descriptions: location of trays (at), location/availability of ingredients (at_kitchen_bread, at_kitchen_content), dietary needs (no_gluten_bread, no_gluten_content, allergic_gluten, not_allergic_gluten), state of children (waiting, served), state of sandwiches (notexist, in_kitchen, on_tray, is_gluten_free)."
        ]
    },
    "workflow": {
        "orchestrator": {
            "pddl_generation": {
                "input": [],
                "output": "final_pddl",
                "system_prompt": "You are an expert PDDL planner. You must complete the provided PDDL Domain template by defining all necessary predicates, preconditions, and effects based on the natural language description. Then, ensure the provided PDDL Problem template is consistent with the derived Domain and accurately reflects the initial state and goal. You always enclose the PDDL domain between <domain></domain> tags, and the PDDL problem between <problem></problem> tags.",
                "prompt": "Here is the natural language description of the domain:\n<domain_nl>\nThe child-snack domain is designed to plan the preparation and serving of sandwiches to children, some of whom have gluten allergies. The domain includes actions for making sandwiches with and without gluten, placing sandwiches on trays, moving trays between places, and serving the sandwiches to the children.\n\nActions:\n1. make_sandwich_no_gluten: Preconditions: gluten-free bread/content available, sandwich does not exist. Effect: GF bread/content consumed, GF sandwich available in kitchen.\n2. make_sandwich: Preconditions: bread/content available, sandwich does not exist. Effect: bread/content consumed, sandwich available in kitchen.\n3. put_on_tray: Preconditions: sandwich in kitchen, tray in kitchen. Effect: sandwich moved from kitchen to tray.\n4. serve_sandwich_no_gluten: Preconditions: child allergic, child waiting at place P, GF sandwich on tray T at P. Effect: sandwich removed, child served.\n5. serve_sandwich: Preconditions: child NOT allergic, child waiting at place P, sandwich on tray T at P. Effect: sandwich removed, child served.\n6. move_tray: Precondition: tray at P1. Effect: tray moved to P2.\n</domain_nl>\n\nHere is the PDDL Domain Template:\n<domain_template>\n(define (domain child-snack)\n  (:requirements :typing :equality)\n  (:types child bread-portion content-portion sandwich tray place)\n  (:constants kitchen - place)\n  (:predicates)\n  (:action make_sandwich_no_gluten :parameters (?s - sandwich ?b - bread-portion ?c - content-portion) :precondition () :effect ())\n  (:action make_sandwich :parameters (?s - sandwich ?b - bread-portion ?c - content-portion) :precondition () :effect ())\n  (:action put_on_tray :parameters (?s - sandwich ?t - tray) :precondition () :effect ())\n  (:action serve_sandwich_no_gluten :parameters (?s - sandwich ?c - child ?t - tray ?p - place) :precondition () :effect ())\n  (:action serve_sandwich :parameters (?s - sandwich ?c - child ?t - tray ?p - place) :precondition () :effect ())\n  (:action move_tray :parameters (?t - tray ?p1 ?p2 - place) :precondition () :effect ())\n)\n</domain_template>\n\nHere is the PDDL Problem Template:\n<problem_pddl>\n; child-snack task with 13 children and 0.4 gluten factor \n; constant factor of 1.3\n; random seed: 234324\n\n(define (problem prob-snack)\n  (:domain child-snack)\n  (:objects\n    child1 child2 child3 child4 child5 child6 child7 child8 child9 child10 child11 child12 child13 - child\n    bread1 bread2 bread3 bread4 bread5 bread6 bread7 bread8 bread9 bread10 bread11 bread12 bread13 - bread-portion\n    content1 content2 content3 content4 content5 content6 content7 content8 content9 content10 content11 content12 content13 - content-portion\n    tray1 tray2 tray3 - tray\n    table1 table2 table3 - place\n    sandw1 sandw2 sandw3 sandw4 sandw5 sandw6 sandw7 sandw8 sandw9 sandw10 sandw11 sandw12 sandw13 sandw14 sandw15 sandw16 sandw17 - sandwich\n  )\n  (:init\n     (at tray1 kitchen)\n     (at tray2 kitchen)\n     (at tray3 kitchen)\n     (at_kitchen_bread bread1)\n     (at_kitchen_bread bread2)\n     (at_kitchen_bread bread3)\n     (at_kitchen_bread bread4)\n     (at_kitchen_bread bread5)\n     (at_kitchen_bread bread6)\n     (at_kitchen_bread bread7)\n     (at_kitchen_bread bread8)\n     (at_kitchen_bread bread9)\n     (at_kitchen_bread bread10)\n     (at_kitchen_bread bread11)\n     (at_kitchen_bread bread12)\n     (at_kitchen_bread bread13)\n     (at_kitchen_content content1)\n     (at_kitchen_content content2)\n     (at_kitchen_content content3)\n     (at_kitchen_content content4)\n     (at_kitchen_content content5)\n     (at_kitchen_content content6)\n     (at_kitchen_content content7)\n     (at_kitchen_content content8)\n     (at_kitchen_content content9)\n     (at_kitchen_content content10)\n     (at_kitchen_content content11)\n     (at_kitchen_content content12)\n     (at_kitchen_content content13)\n     (no_gluten_bread bread3)\n     (no_gluten_bread bread12)\n     (no_gluten_bread bread5)\n     (no_gluten_bread bread11)\n     (no_gluten_bread bread1)\n     (no_gluten_content content11)\n     (no_gluten_content content6)\n     (no_gluten_content content2)\n     (no_gluten_content content10)\n     (no_gluten_content content4)\n     (allergic_gluten child8)\n     (allergic_gluten child1)\n     (allergic_gluten child12)\n     (allergic_gluten child4)\n     (allergic_gluten child13)\n     (not_allergic_gluten child2)\n     (not_allergic_gluten child3)\n     (not_allergic_gluten child5)\n     (not_allergic_gluten child6)\n     (not_allergic_gluten child7)\n     (not_allergic_gluten child9)\n     (not_allergic_gluten child10)\n     (not_allergic_gluten child11)\n     (waiting child1 table2)\n     (waiting child2 table3)\n     (waiting child3 table3)\n     (waiting child4 table3)\n     (waiting child5 table2)\n     (waiting child6 table1)\n     (waiting child7 table3)\n     (waiting child8 table1)\n     (waiting child9 table1)\n     (waiting child10 table3)\n     (waiting child11 table1)\n     (waiting child12 table1)\n     (waiting child13 table1)\n     (notexist sandw1)\n     (notexist sandw2)\n     (notexist sandw3)\n     (notexist sandw4)\n     (notexist sandw5)\n     (notexist sandw6)\n     (notexist sandw7)\n     (notexist sandw8)\n     (notexist sandw9)\n     (notexist sandw10)\n     (notexist sandw11)\n     (notexist sandw12)\n     (notexist sandw13)\n     (notexist sandw14)\n     (notexist sandw15)\n     (notexist sandw16)\n     (notexist sandw17)\n  )\n  (:goal\n    (and\n     (served child1)\n     (served child2)\n     (served child3)\n     (served child4)\n     (served child5)\n     (served child6)\n     (served child7)\n     (served child8)\n     (served child9)\n     (served child10)\n     (served child11)\n     (served child12)\n     (served child13)\n    )\n  )\n)\n</problem_pddl>\n\nGenerate the complete PDDL domain, filling in all predicates, preconditions, and effects, and confirm the PDDL problem (the initial state facts must be consistent with the derived domain predicates)."
            }
        },
        "auditor": {
            "audit": {
                "input": [
                    "final_pddl"
                ],
                "output": "audit_result",
                "system_prompt": "You are a PDDL consistency and validity auditor. Your role is to examine the provided PDDL Domain and Problem pair for FastDownwards compatibility. You must check temporal and causal consistency by ensuring that all predicates used in the Problem's initial state and goal match the predicates defined and used consistently in the Domain's actions, and that no action introduces conflicts or relies on undefined states. Provide a brief summary of your findings and suggest necessary corrections if inconsistencies are found.",
                "prompt": "Review the following PDDL package:\n{final_pddl}\n\nBased on the natural language requirements:\n1. Are all required predicates defined?\n2. Are the pre-conditions and effects logically sound and consistent with the domain description?\n3. Is the plan solvable based on the defined resources (13 children need 13 sandwiches, 13 bread/content available)?\n4. Provide the final audit report."
            }
        },
        "constraints": [
            "orchestrator.pddl_generation->auditor.audit"
        ]
    }
}