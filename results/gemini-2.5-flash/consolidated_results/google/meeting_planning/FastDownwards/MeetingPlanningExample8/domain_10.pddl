(define (domain meeting-planning)
    (:requirements :strips :typing :negative-preconditions :action-costs)
    (:types
        location
        person
        timepoint
        minute-step
    )
    (:predicates
        (at ?l - location)
        (met ?p - person)
        (meeting-ongoing ?p - person)
        (at-time ?t - timepoint)
        (S-met-m ?m - minute-step)
        
        (is-next-minute ?m1 ?m2 - minute-step)
        (is-12-minutes-after ?t1 ?t2 - timepoint) ; Ctown -> Mdist (12 min)
        (is-16-minutes-after ?t1 ?t2 - timepoint) ; Mdist -> Ctown (16 min)
        (is-1-minute-after ?t1 ?t2 - timepoint) ; Explicit 1 minute progression
        
        (before-t256 ?t - timepoint) ; Start Time t <= T255 (Latest possible start time to meet 105 mins by T360)
        (before-t361 ?t - timepoint) ; Time t <= T360 (3:00 PM Deadline)
    )

    (:functions
        (total-cost)
        (friends-met)
    )

    ;; Travel Ctown -> Mdist (12 mins)
    (:action travel_ctown_to_mdist
        :parameters (?t1 ?t12 - timepoint)
        :precondition (and (at ctown)
                          (at-time ?t1)
                          (not (meeting-ongoing stephanie))
                          (is-12-minutes-after ?t1 ?t12)
                          (before-t361 ?t12)
                        )
        :effect (and (not (at ctown))
                    (at mdist)
                    (not (at-time ?t1))
                    (at-time ?t12)
                    (increase (total-cost) 1)
        )
    )

    ;; Travel Mdist -> Ctown (16 mins)
    (:action travel_mdist_to_ctown
        :parameters (?t1 ?t16 - timepoint)
        :precondition (and (at mdist)
                          (at-time ?t1)
                          (not (meeting-ongoing stephanie))
                          (is-16-minutes-after ?t1 ?t16)
                          (before-t361 ?t16)
                        )
        :effect (and (not (at mdist))
                    (at ctown)
                    (not (at-time ?t1))
                    (at-time ?t16)
                    (increase (total-cost) 1)
        )
    )
    
    ;; Wait action (1 minute step for flexibility/time progression outside meetings)
    (:action wait_1_minute
        :parameters (?t1 ?t2 - timepoint ?l - location)
        :precondition (and (at ?l)
                          (at-time ?t1)
                          (not (meeting-ongoing stephanie))
                          (is-1-minute-after ?t1 ?t2) 
                          (before-t361 ?t2)
                          )
        :effect (and (not (at-time ?t1))
                    (at-time ?t2)
                    (increase (total-cost) 1)
        )
    )

    ;; Start Meeting Stephanie
    (:action start_meeting_stephanie
        :parameters (?t - timepoint)
        :precondition (and (at mdist)
                          (not (met stephanie))
                          (not (meeting-ongoing stephanie))
                          (at-time ?t)
                          (before-t256 ?t) 
                          )
        :effect (and (meeting-ongoing stephanie)
                    (S-met-m m0)
                    (increase (total-cost) 1) 
        )
    )
    
    ;; Required Meeting Increment (1 minute time step)
    (:action meet_stephanie_required_increment
        :parameters (?t1 ?t2 - timepoint ?m1 ?m2 - minute-step)
        :precondition (and (meeting-ongoing stephanie)
                          (at-time ?t1)
                          (S-met-m ?m1)
                          (is-next-minute ?m1 ?m2)
                          (is-1-minute-after ?t1 ?t2) 
                          (before-t361 ?t2)
                          )
        :effect (and (not (S-met-m ?m1))
                    (S-met-m ?m2)
                    (not (at-time ?t1))
                    (at-time ?t2)
                    (increase (total-cost) 1)
        )
    )

    ;; End Meeting Stephanie (Requires m105 reached, 105 min minimum satisfied)
    (:action end_meeting_stephanie
        :parameters (?t - timepoint)
        :precondition (and (meeting-ongoing stephanie)
                          (at-time ?t)
                          (S-met-m m105)
                          (before-t361 ?t)
                          )
        :effect (and (not (meeting-ongoing stephanie))
                    (met stephanie)
                    (increase (friends-met) 1)
                    (increase (total-cost) 1)
        )
    )

    ;; Optional continuation after m105 (1 minute extension)
    (:action meet_stephanie_extension
        :parameters (?t1 ?t2 - timepoint)
        :precondition (and (meeting-ongoing stephanie)
                          (S-met-m m105)
                          (at-time ?t1)
                          (is-1-minute-after ?t1 ?t2) 
                          (before-t361 ?t2)
                          )
        :effect (and (not (at-time ?t1))
                    (at-time ?t2)
                    (increase (total-cost) 1)
        )
    )