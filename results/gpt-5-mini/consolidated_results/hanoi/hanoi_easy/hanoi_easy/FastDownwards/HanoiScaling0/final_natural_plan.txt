1. Step 1 — (move-disk-to-peg a b left) — Stage s0 → s1 (duration 1): Move disk a (smallest) from on top of disk b to peg left. Valid: a is top on its peg, left is empty.

2. Step 2 — (move-disk-to-peg b c right) — Stage s1 → s2 (duration 1): Move disk b from on top of disk c to peg right. Valid: b is top on its peg, right is empty.

3. Step 3 — (move-peg-to-disk a left b) — Stage s2 → s3 (duration 1): Move disk a from peg left onto disk b. Valid: a is top on left, b is top on right, and a is smaller than b.

4. Step 4 — (move-disk-to-peg c d left) — Stage s3 → s4 (duration 1): Move disk c from on top of disk d to peg left. Valid: c is top on its peg, left is empty after step 3.

5. Step 5 — (move-disk-to-disk a b d) — Stage s4 → s5 (duration 1): Move disk a from on top of disk b onto disk d. Valid: a is top on b, d is top on middle, and a is smaller than d.

6. Step 6 — (move-peg-to-disk b right c) — Stage s5 → s6 (duration 1): Move disk b from peg right onto disk c. Valid: b is top on right, c is top on left, and b is smaller than c.

7. Step 7 — (move-disk-to-disk a d b) — Stage s6 → s7 (duration 1): Move disk a from on top of disk d onto disk b. Valid: a is top on d, b is top on c, and a is smaller than b.

8. Step 8 — (move-peg-to-peg d middle right) — Stage s7 → s8 (duration 1): Move disk d from peg middle to peg right. Valid: d is top on middle (after a moved off), right has space below larger/smaller constraints respected.

9. Step 9 — (move-disk-to-disk a b d) — Stage s8 → s9 (duration 1): Move disk a from on top of disk b onto disk d. Valid: a is top on b, d is top on right, and a is smaller than d.

10. Step 10 — (move-disk-to-peg b c middle) — Stage s9 → s10 (duration 1): Move disk b from on top of disk c to peg middle. Valid: b is top on c, middle is empty.

11. Step 11 — (move-disk-to-disk a d b) — Stage s10 → s11 (duration 1): Move disk a from on top of disk d onto disk b. Valid: a is top on d, b is top on middle, and a is smaller than b.

12. Step 12 — (move-peg-to-disk c left d) — Stage s11 → s12 (duration 1): Move disk c from peg left onto disk d. Valid: c is top on left, d is top on right, and c is smaller than d.

13. Step 13 — (move-disk-to-peg a b left) — Stage s12 → s13 (duration 1): Move disk a from on top of disk b to peg left. Valid: a is top on b, left is empty.

14. Step 14 — (move-peg-to-disk b middle c) — Stage s13 → s14 (duration 1): Move disk b from peg middle onto disk c. Valid: b is top on middle, c is top on right, and b is smaller than c.

15. Step 15 — (move-peg-to-disk a left b) — Stage s14 → s15 (duration 1): Move disk a from peg left onto disk b. Valid: a is top on left, b is top on right, and a is smaller than b.

Final state (after Stage s15): Right peg holds stack top-to-bottom a on b on c on d; left and middle pegs are empty; at-stage s15 reached. All moves respect the rules: single top-disk moves only and no larger disk placed on a smaller disk.