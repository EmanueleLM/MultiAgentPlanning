(define (domain multi-city-trip)
  (:requirements :typing :negative-preconditions :adl :action-costs :fluents)
  (:types city day porto-cap barca-cap flor-cap)
  (:predicates
    (at ?c - city)
    (current ?d - day)
    (next ?d1 - day ?d2 - day)
    (day-unused ?d - day)
    (assigned ?d - day ?c - city)
    (porto-cap-available ?p - porto-cap)
    (porto-cap-used ?p - porto-cap)
    (barca-cap-available ?b - barca-cap)
    (barca-cap-used ?b - barca-cap)
    (flor-cap-available ?f - flor-cap)
    (flor-cap-used ?f - flor-cap)
    (relatives-visited)
  )
  (:functions (total-cost))

  (:action stay-porto
    :parameters (?d - day ?d2 - day ?pc - porto-cap)
    :precondition (and (current ?d) (next ?d ?d2) (at porto) (day-unused ?d) (porto-cap-available ?pc))
    :effect (and
      (not (day-unused ?d))
      (assigned ?d porto)
      (not (porto-cap-available ?pc))
      (porto-cap-used ?pc)
      (not (current ?d))
      (current ?d2)
      (increase (total-cost) 1)
    )
  )

  (:action stay-barcelona
    :parameters (?d - day ?d2 - day ?bc - barca-cap)
    :precondition (and (current ?d) (next ?d ?d2) (at barcelona) (day-unused ?d) (barca-cap-available ?bc))
    :effect (and
      (not (day-unused ?d))
      (assigned ?d barcelona)
      (not (barca-cap-available ?bc))
      (barca-cap-used ?bc)
      (not (current ?d))
      (current ?d2)
      (increase (total-cost) 1)
    )
  )

  (:action stay-florence
    :parameters (?d - day ?d2 - day ?fc - flor-cap)
    :precondition (and (current ?d) (next ?d ?d2) (at florence) (day-unused ?d) (flor-cap-available ?fc))
    :effect (and
      (not (day-unused ?d))
      (assigned ?d florence)
      (not (flor-cap-available ?fc))
      (flor-cap-used ?fc)
      (not (current ?d))
      (current ?d2)
      (increase (total-cost) 1)
    )
  )

  (:action fly-porto-to-barcelona
    :parameters (?d - day ?d2 - day ?bc - barca-cap)
    :precondition (and (current ?d) (next ?d ?d2) (at porto) (day-unused ?d) (barca-cap-available ?bc))
    :effect (and
      (not (day-unused ?d))
      (assigned ?d barcelona)
      (not (barca-cap-available ?bc))
      (barca-cap-used ?bc)
      (not (at porto))
      (at barcelona)
      (not (current ?d))
      (current ?d2)
      (increase (total-cost) 1)
    )
  )

  (:action fly-barcelona-to-porto
    :parameters (?d - day ?d2 - day ?pc - porto-cap)
    :precondition (and (current ?d) (next ?d ?d2) (at barcelona) (day-unused ?d) (porto-cap-available ?pc))
    :effect (and
      (not (day-unused ?d))
      (assigned ?d porto)
      (not (porto-cap-available ?pc))
      (porto-cap-used ?pc)
      (not (at barcelona))
      (at porto)
      (not (current ?d))
      (current ?d2)
      (increase (total-cost) 1)
    )
  )

  (:action fly-barcelona-to-florence
    :parameters (?d - day ?d2 - day ?fc - flor-cap)
    :precondition (and (current ?d) (next ?d ?d2) (at barcelona) (day-unused ?d) (flor-cap-available ?fc))
    :effect (and
      (not (day-unused ?d))
      (assigned ?d florence)
      (not (flor-cap-available ?fc))
      (flor-cap-used ?fc)
      (not (at barcelona))
      (at florence)
      (not (current ?d))
      (current ?d2)
      (increase (total-cost) 1)
    )
  )

  (:action fly-florence-to-barcelona
    :parameters (?d - day ?d2 - day ?bc - barca-cap)
    :precondition (and (current ?d) (next ?d ?d2) (at florence) (day-unused ?d) (barca-cap-available ?bc))
    :effect (and
      (not (day-unused ?d))
      (assigned ?d barcelona)
      (not (barca-cap-available ?bc))
      (barca-cap-used ?bc)
      (not (at florence))
      (at barcelona)
      (not (current ?d))
      (current ?d2)
      (increase (total-cost) 1)
    )
  )

  (:action visit-relatives-in-porto
    :parameters ()
    :precondition (and (at porto) (not (relatives-visited))
                       (or (current day1) (current day2) (current day3)))
    :effect (relatives-visited)
  )
)