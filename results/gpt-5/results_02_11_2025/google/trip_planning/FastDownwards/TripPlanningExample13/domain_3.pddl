(define (domain trip-17days)
  (:requirements :strips :typing :negative-preconditions)
  (:types day city)
  (:predicates
    (next ?d - day ?dn - day)
    (lastday ?d - day)
    (current ?d - day)
    (unassigned ?d - day)
    (scheduled ?d - day)
    (assigned ?d - day ?c - city)
    (started)
    (last ?c - city)
    (flight ?c1 - city ?c2 - city)
    (require-lyon ?d - day)
    (is-lyon ?c - city)
    (visited ?c - city)
  )

  (:action assign-first-nonlyon-mid
    :parameters (?d - day ?c - city ?dn - day)
    :precondition (and (current ?d) (unassigned ?d) (not (started))
                       (not (require-lyon ?d)) (not (lastday ?d)) (next ?d ?dn)
                       (not (is-lyon ?c)))
    :effect (and (assigned ?d ?c) (scheduled ?d) (not (unassigned ?d))
                 (started) (last ?c) (visited ?c) (not (current ?d)) (current ?dn))
  )

  (:action assign-first-nonlyon-final
    :parameters (?d - day ?c - city)
    :precondition (and (current ?d) (unassigned ?d) (not (started))
                       (not (require-lyon ?d)) (lastday ?d)
                       (not (is-lyon ?c)))
    :effect (and (assigned ?d ?c) (scheduled ?d) (not (unassigned ?d))
                 (started) (last ?c) (visited ?c) (not (current ?d)))
  )

  (:action assign-same-nonlyon-mid
    :parameters (?d - day ?c - city ?dn - day)
    :precondition (and (started) (current ?d) (unassigned ?d)
                       (last ?c) (not (require-lyon ?d))
                       (not (is-lyon ?c))
                       (not (lastday ?d)) (next ?d ?dn))
    :effect (and (assigned ?d ?c) (scheduled ?d) (not (unassigned ?d))
                 (visited ?c)
                 (not (current ?d)) (current ?dn))
  )

  (:action assign-same-nonlyon-final
    :parameters (?d - day ?c - city)
    :precondition (and (started) (current ?d) (unassigned ?d)
                       (last ?c) (not (require-lyon ?d))
                       (not (is-lyon ?c))
                       (lastday ?d))
    :effect (and (assigned ?d ?c) (scheduled ?d) (not (unassigned ?d))
                 (visited ?c)
                 (not (current ?d)))
  )

  (:action assign-change-nonlyon-mid
    :parameters (?d - day ?prev - city ?c - city ?dn - day)
    :precondition (and (started) (current ?d) (unassigned ?d)
                       (last ?prev) (not (last ?c)) (flight ?prev ?c)
                       (not (require-lyon ?d))
                       (not (is-lyon ?c))
                       (not (lastday ?d)) (next ?d ?dn))
    :effect (and (assigned ?d ?c) (scheduled ?d) (not (unassigned ?d))
                 (not (last ?prev)) (last ?c) (visited ?c)
                 (not (current ?d)) (current ?dn))
  )

  (:action assign-change-nonlyon-final
    :parameters (?d - day ?prev - city ?c - city)
    :precondition (and (started) (current ?d) (unassigned ?d)
                       (last ?prev) (not (last ?c)) (flight ?prev ?c)
                       (not (require-lyon ?d))
                       (not (is-lyon ?c))
                       (lastday ?d))
    :effect (and (assigned ?d ?c) (scheduled ?d) (not (unassigned ?d))
                 (not (last ?prev)) (last ?c) (visited ?c)
                 (not (current ?d)))
  )

  (:action assign-first-lyon-mid
    :parameters (?d - day ?dn - day ?ly - city)
    :precondition (and (current ?d) (unassigned ?d) (not (started))
                       (require-lyon ?d) (not (lastday ?d)) (next ?d ?dn)
                       (is-lyon ?ly))
    :effect (and (assigned ?d ?ly) (scheduled ?d) (not (unassigned ?d))
                 (started) (last ?ly) (visited ?ly) (not (current ?d)) (current ?dn))
  )

  (:action assign-first-lyon-final
    :parameters (?d - day ?ly - city)
    :precondition (and (current ?d) (unassigned ?d) (not (started))
                       (require-lyon ?d) (lastday ?d)
                       (is-lyon ?ly))
    :effect (and (assigned ?d ?ly) (scheduled ?d) (not (unassigned ?d))
                 (started) (last ?ly) (visited ?ly) (not (current ?d)))
  )

  (:action assign-same-lyon-mid
    :parameters (?d - day ?dn - day ?ly - city)
    :precondition (and (started) (current ?d) (unassigned ?d)
                       (require-lyon ?d) (last ?ly) (is-lyon ?ly)
                       (not (lastday ?d)) (next ?d ?dn))
    :effect (and (assigned ?d ?ly) (scheduled ?d) (not (unassigned ?d))
                 (visited ?ly)
                 (not (current ?d)) (current ?dn))
  )

  (:action assign-same-lyon-final
    :parameters (?d - day ?ly - city)
    :precondition (and (started) (current ?d) (unassigned ?d)
                       (require-lyon ?d) (last ?ly) (is-lyon ?ly) (lastday ?d))
    :effect (and (assigned ?d ?ly) (scheduled ?d) (not (unassigned ?d))
                 (visited ?ly)
                 (not (current ?d)))
  )

  (:action assign-change-to-lyon-mid
    :parameters (?d - day ?prev - city ?dn - day ?ly - city)
    :precondition (and (started) (current ?d) (unassigned ?d)
                       (require-lyon ?d) (last ?prev) (not (last ?ly))
                       (flight ?prev ?ly) (is-lyon ?ly)
                       (not (lastday ?d)) (next ?d ?dn))
    :effect (and (assigned ?d ?ly) (scheduled ?d) (not (unassigned ?d))
                 (not (last ?prev)) (last ?ly) (visited ?ly)
                 (not (current ?d)) (current ?dn))
  )

  (:action assign-change-to-lyon-final
    :parameters (?d - day ?prev - city ?ly - city)
    :precondition (and (started) (current ?d) (unassigned ?d)
                       (require-lyon ?d) (last ?prev) (not (last ?ly))
                       (flight ?prev ?ly) (is-lyon ?ly)
                       (lastday ?d))
    :effect (and (assigned ?d ?ly) (scheduled ?d) (not (unassigned ?d))
                 (not (last ?prev)) (last ?ly) (visited ?ly)
                 (not (current ?d)))
  )
)