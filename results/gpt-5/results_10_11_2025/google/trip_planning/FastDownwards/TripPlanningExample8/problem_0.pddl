(define (problem trip16-final)
  (:domain trip-16days)
  (:objects
    day1 day2 day3 day4 day5 day6 day7 day8 day9 day10 day11 day12 day13 day14 day15 day16 - day
    athens zurich krakow - city
  )
  (:init
    ; Connectivity graph (only direct flights allowed)
    (edge athens zurich)
    (edge zurich athens)
    (edge zurich krakow)
    (edge krakow zurich)
    ; No Athens <-> Krakow edge (forbidden)

    ; Day order and adjacency
    (first day1)
    (next day1 day2) (prev day2 day1)
    (next day2 day3) (prev day3 day2)
    (next day3 day4) (prev day4 day3)
    (next day4 day5) (prev day5 day4)
    (next day5 day6) (prev day6 day5)
    (next day6 day7) (prev day7 day6)
    (next day7 day8) (prev day8 day7)
    (next day8 day9) (prev day9 day8)
    (next day9 day10) (prev day10 day9)
    (next day10 day11) (prev day11 day10)
    (next day11 day12) (prev day12 day11)
    (next day12 day13) (prev day13 day12)
    (next day13 day14) (prev day14 day13)
    (next day14 day15) (prev day15 day14)
    (next day15 day16) (prev day16 day15)

    ; Mandatory Athens stay: days 1..7 inclusive must be Athens
    (must-athens day1)
    (must-athens day2)
    (must-athens day3)
    (must-athens day4)
    (must-athens day5)
    (must-athens day6)
    (must-athens day7)

    ; Soft preferences (commented; enforced via fixed goals below)
    ; Targets: Athens=7 (hard, enforced), Zurich=5, Krakow=6. Total targets=18 > 16 days.
    ; Auditor’s resolution: Keep Athens=7 and Krakow=6; reduce Zurich to 3 (minimal deviation 2).
    ; Final recommended allocation encoded in goals matches:
    ;   Athens: days 1–7
    ;   Zurich: days 8–10
    ;   Krakow: days 11–16
    ; Flight sequence implied by goals and link validation:
    ;   day7->day8: Athens -> Zurich (flight)
    ;   day10->day11: Zurich -> Krakow (flight)
  )
  (:goal (and
    ; Exactly one city per day is enforced by assignment actions and these exact-at goals
    (assigned day1)
    (assigned day2)
    (assigned day3)
    (assigned day4)
    (assigned day5)
    (assigned day6)
    (assigned day7)
    (assigned day8)
    (assigned day9)
    (assigned day10)
    (assigned day11)
    (assigned day12)
    (assigned day13)
    (assigned day14)
    (assigned day15)
    (assigned day16)

    ; Final recommended city allocation (fixes the schedule uniquely)
    (at day1 athens)
    (at day2 athens)
    (at day3 athens)
    (at day4 athens)
    (at day5 athens)
    (at day6 athens)
    (at day7 athens)
    (at day8 zurich)
    (at day9 zurich)
    (at day10 zurich)
    (at day11 krakow)
    (at day12 krakow)
    (at day13 krakow)
    (at day14 krakow)
    (at day15 krakow)
    (at day16 krakow)

    ; Validate every consecutive transition in order (stay or direct flight only)
    (linked day1)
    (linked day2)
    (linked day3)
    (linked day4)
    (linked day5)
    (linked day6)
    (linked day7)
    (linked day8)
    (linked day9)
    (linked day10)
    (linked day11)
    (linked day12)
    (linked day13)
    (linked day14)
    (linked day15)
  ))
)