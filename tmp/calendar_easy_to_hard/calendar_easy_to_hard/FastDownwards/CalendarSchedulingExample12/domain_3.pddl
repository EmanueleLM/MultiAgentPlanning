(define (domain integrated-schedule-meeting)
  (:requirements :typing :strips :negative-preconditions)
  (:types person hour halfslot meeting)

  (:predicates
    (free_hour ?p - person ?h - hour)
    (unscheduled ?m - meeting)
    (free_half ?p - person ?s - halfslot)
    (slot-next ?s1 - halfslot ?s2 - halfslot)
    (meeting-available)
    (available_hour ?p - person ?h - hour)
    (slot ?h - hour)
    (within-window ?h - hour)
    (hour-starts ?h - hour ?s - halfslot)
    (meeting-free)
    (meeting-scheduled-global ?m - meeting)
    (scheduled-at ?m - meeting ?h - hour)
    (meeting-start-at-half ?s - halfslot)
    (attends ?p - person ?m - meeting)
    (free_hour_agg ?p - person ?h - hour)
  )

  (:action schedule-by-agent1
    :parameters (?m - meeting ?h - hour ?p1 - person ?p2 - person ?p3 - person)
    :precondition (and
                    (unscheduled ?m)
                    (meeting-free)
                    (free_hour ?p1 ?h) (free_hour ?p2 ?h) (free_hour ?p3 ?h)
                    (free_hour_agg ?p1 ?h) (free_hour_agg ?p2 ?h) (free_hour_agg ?p3 ?h)
                  )
    :effect (and
              (meeting-scheduled-global ?m)
              (scheduled-at ?m ?h)
              (attends ?p1 ?m) (attends ?p2 ?m) (attends ?p3 ?m)
              (not (unscheduled ?m))
              (not (meeting-free))
              (not (free_hour ?p1 ?h)) (not (free_hour ?p2 ?h)) (not (free_hour ?p3 ?h))
            )
  )

  (:action schedule-by-agent2
    :parameters (?m - meeting ?s1 - halfslot ?s2 - halfslot ?h - hour ?p1 - person ?p2 - person ?p3 - person)
    :precondition (and
                    (slot-next ?s1 ?s2)
                    (hour-starts ?h ?s1)
                    (meeting-available)
                    (meeting-free)
                    (free_half ?p1 ?s1) (free_half ?p1 ?s2)
                    (free_half ?p2 ?s1) (free_half ?p2 ?s2)
                    (free_half ?p3 ?s1) (free_half ?p3 ?s2)
                    (free_hour_agg ?p1 ?h) (free_hour_agg ?p2 ?h) (free_hour_agg ?p3 ?h)
                  )
    :effect (and
              (not (meeting-available))
              (meeting-scheduled-global ?m)
              (meeting-start-at-half ?s1)
              (scheduled-at ?m ?h)
              (attends ?p1 ?m) (attends ?p2 ?m) (attends ?p3 ?m)
              (not (free_half ?p1 ?s1)) (not (free_half ?p1 ?s2))
              (not (free_half ?p2 ?s1)) (not (free_half ?p2 ?s2))
              (not (free_half ?p3 ?s1)) (not (free_half ?p3 ?s2))
              (not (meeting-free))
            )
  )

  (:action schedule-by-agent3
    :parameters (?m - meeting ?h - hour ?p1 - person ?p2 - person ?p3 - person)
    :precondition (and
                    (slot ?h)
                    (within-window ?h)
                    (meeting-free)
                    (available_hour ?p1 ?h) (available_hour ?p2 ?h) (available_hour ?p3 ?h)
                    (free_hour_agg ?p1 ?h) (free_hour_agg ?p2 ?h) (free_hour_agg ?p3 ?h)
                  )
    :effect (and
              (meeting-scheduled-global ?m)
              (scheduled-at ?m ?h)
              (attends ?p1 ?m) (attends ?p2 ?m) (attends ?p3 ?m)
              (not (meeting-free))
            )
  )
)